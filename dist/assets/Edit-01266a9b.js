import{i as L,u as P,r as n,ab as $,k as D,aD as F,j as r,l as N,am as p,h as w}from"./index-4b3d7bc8.js";import{I as R}from"./InvoiceForm-947481b2.js";import{u as V}from"./usePermissions-36032956.js";import{A as G}from"./AccessDenied-45b92511.js";import"./AddressModal-12b3ae58.js";import"./CustomerTab-c6c321f7.js";import"./useListing-af775608.js";import"./useDelayUnmount-cb77ae7b.js";import"./index-b8658cbe.js";import"./progress-e3fed29d.js";import"./ImageUploader-b2d6894b.js";import"./Create-76ba1395.js";import"./ContactDetailModal-bc8d3392.js";import"./DetailPage-c0159ae7.js";import"./capitalize-cfd5966b.js";import"./Table-9972bb2a.js";import"./Processing-a1197381.js";import"./PaginateSelect-b668bdaf.js";import"./ItemTable-c0313657.js";import"./react-beautiful-dnd.esm-fdc0d50f.js";import"./Create-8edeb959.js";import"./ItemForm-ceb885e2.js";import"./ImageCrop-db92a92e.js";import"./index-d9b76a87.js";import"./Create-93e4462e.js";import"./calculation-671db1b1.js";import"./itemDetailModal-4a763e01.js";import"./DetailPage-51a1d58a.js";const{INVOICES:_}=N,_t=()=>{const g=L(),{callAxios:a}=P(),[h,I]=n.useState(0),[f,c]=$(),[j]=D(),s=j.get("id"),{checkPermission:x}=V(),[o,b]=n.useState([]),{has_InvoiceEdit_permission:E}=x("InvoiceEdit"),{data:A=[]}=F(""),S=n.useCallback(t=>I(t),[]),T=n.useCallback(t=>b(t),[]),k=({values:t})=>{var d,e;console.log({values:t});const m=o==null?void 0:o.filter(i=>i.id!==null),y=m==null?void 0:m.map(i=>({...i,item_obj:null,amount:0})),C={...t,total:h,items:y,discount_type:"",discount_level:"",discount_transaction_level:0,adjustment:(t==null?void 0:t.adjustment)||0,shipping_charge:(t==null?void 0:t.shipping_charge)||0,billing_address_id:(d=t==null?void 0:t.billing_address_id)==null?void 0:d.id,invoice_terms:typeof(t==null?void 0:t.invoice_terms)!="object"?A.find(i=>i.id===(t==null?void 0:t.invoice_terms))||{}:t.invoice_terms,due_date:p(t==null?void 0:t.due_date),invoice_date:p(t==null?void 0:t.invoice_date),status:(t==null?void 0:t.saveAs)==="sent"?"sent":"draft",customer_id:typeof(t==null?void 0:t.customer_id)=="object"?(e=t==null?void 0:t.customer_id)==null?void 0:e.id:t==null?void 0:t.customer_id};c(),a({method:"put",url:`${_}/${s}/update`,data:C}).then(i=>{c(),i&&(w({message:i.message}),g(-1))})};return r.jsx(r.Fragment,{children:E?r.jsx(R,{item:o,loading:f,onSubmit:k,handleTotal:S,handleItemList:T,url:`${_}/${s}/edit`}):r.jsx(G,{})})};export{_t as default};
