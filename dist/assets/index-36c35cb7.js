import{i as M,k as R,r as s,u as W,j as o,l as N,h as p}from"./index-4b3d7bc8.js";import{I as U}from"./ItemForm-ceb885e2.js";import{u as z}from"./usePermissions-36032956.js";import{A as B}from"./AccessDenied-45b92511.js";import"./ImageCrop-db92a92e.js";import"./ImageUploader-b2d6894b.js";import"./progress-e3fed29d.js";import"./index-d9b76a87.js";import"./index-b8658cbe.js";const{ITEMS:g}=N,v=()=>{const f=M(),[k]=R(),x=k.get("id"),{checkPermission:y}=z(),[c,b]=s.useState(!1),{callAxios:I,toggle:j,bool:L}=W(),[T,S]=s.useState(),[r,i]=s.useState([]),[d,_]=s.useState([]),{has_ItemCreate_permission:C}=y("ItemCreate"),[O,w]=s.useState([]),A=t=>S(t),E=t=>b(t),F=s.useCallback(t=>{i(t)},[]),$=s.useCallback(t=>i(t),[]),P=s.useCallback(t=>{_(t)},[]),q=s.useCallback(t=>{w(t)},[]),D=t=>{const m=[],l=[];r.forEach(e=>{e.old_image?m.push(e.name):l.push(e)});const u=[],h=[];if(d.forEach(e=>{e.old_image?h.push(e.url):u.push(e.originFileObj)}),t.opening_stock>0&&t.opening_stock_value<=0)p({message:"Opening stock value field is required",type:"info"});else if(t.opening_stock<=0&&t.opening_stock_value>0)p({message:"Opening stock value field is required",type:"info"});else{let e=new FormData;e.append("sku",t.sku),e.append("unit",t.unit),e.append("name",t.name),e.append("brand",t.brand),e.append("weight",t.weight),e.append("clone_status",1),e.append("tax_type",T||null),e.append("dimensions",t.dimensions),e.append("tax_id",t.tax_id||null),e.append("category_id",t.category_id),e.append("manufacturer",t.manufacturer),e.append("description",t.description||""),e.append("reorder_level",t.reorder_level||0),e.append("sales_account_id",t.sales_account_id),e.append("sales_unit_price",t.sales_unit_price||0),e.append("purchase_account_id",t.purchase_account_id),e.append("type",t.type==="Inventory"?"goods":""),e.append("sales_description",t.sales_description||""),e.append("purchase_unit_price",t.purchase_unit_price||0),e.append("opening_stock_value",t.opening_stock_value||0),e.append("purchase_description",t.purchase_description||""),e.append("warehouses[0][id]",O[0].id),e.append("warehouses[0][opening_stock]",t.opening_stock||0),e.append("inventory_type",c?"inventory":"noninventory");for(let[n,a]of Object.entries(l))e.append(`upload_images[${n}]`,a);for(let[n,a]of Object.entries(m))e.append(`images[${n}]`,a);for(let[n,a]of Object.entries(u))e.append(`attachments[${n}]`,a);for(let[n,a]of Object.entries(h))e.append(`clone_attachments[${n}]`,a);j(),I({method:"post",url:g,data:e}).then(n=>{n&&(p({message:n.message}),f(-1))})}};return o.jsx(o.Fragment,{children:C?o.jsx(U,{clone:!0,loading:L,tracked:c,onSubmit:D,fileList:r,attachList:d,setFileList:i,setAttachList:_,handleTaxType:A,handleFileList:$,handleImageList:F,url:`${g}/${x}/clone`,handleTrackInventory:E,handleWareshouseList:q,handleImageAttachList:P}):o.jsx(B,{})})};export{v as default};
