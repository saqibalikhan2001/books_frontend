import{j as e,J as B,S as b,s as V,T as D,I as k,n as i,F as C,r as u,M as v,A as U,D as G,p as K,B as _,u as y,ai as W,l as P,h as N,f as q,G as J,cq as Q}from"./index-4b3d7bc8.js";import{A as $}from"./AccessDenied-45b92511.js";import{u as O}from"./useSearchParam-ebfda256.js";import{A as X}from"./ActionMenu-149e95aa.js";import{u as Z}from"./usePermissions-36032956.js";const{Title:ee}=D,{MdOutlinePayments:se,VscAdd:te}=k,{NEW_PAYMENT_METHOD:oe,_PAYMENT_METHODS:ne}=i,ae=({closeModal:o})=>e.jsx(B,{title:e.jsxs(b,{children:[e.jsx(se,{size:25}),e.jsx(ee,{level:3,children:ne})]}),extra:[e.jsx(V,{icon:e.jsx(te,{size:14}),className:"pr-color",onClick:o,children:oe},"1")],style:{borderBottom:"1px solid gray",paddingBottom:"0"}}),{AiOutlineUser:le}=k,ie={name:""},re=({toggle:o,visible:r,loading:c,onSubmit:t,current:s,has_permission:l})=>{const[n]=C.useForm();u.useEffect(()=>{s&&Object.keys(s).length&&n.setFieldsValue({...s})},[s,n]);const m=()=>n.resetFields();return e.jsx(v,{title:`${s!=null&&s.name?i.UPDATE:i.CREATE} ${i._PAYMENT_METHOD}`,footer:null,destroyOnClose:!0,open:r,onCancel:o,style:{top:0},maskClosable:!1,afterClose:m,children:l?e.jsxs(C,{name:`${i.ENTER}-${i._PAYMENT_METHOD}`,initialValues:ie,form:n,layout:"vertical",onFinish:t,children:[e.jsx(U,{size:"middle",name:"name",LeftIcon:e.jsx(le,{}),placeholder:`${i.ENTER} ${i.NAME}`,label:`${i._PAYMENT_METHOD} ${i.NAME}`,rules:G({message:K.enter_payment_method_name})}),e.jsxs(b,{className:"steps-action",children:[e.jsx(_,{type:"default",htmlType:"button",clickHandler:o,btnText:i.CANCEL}),e.jsx(_,{block:!0,loading:c,style:{width:"120px"},btnText:s!=null&&s.name?i.UPDATE:i.CREATE})]})]}):e.jsx($,{})})},S=({bool:o,toggle:r,current:c,loading:t,onSubmit:s,has_permission:l})=>e.jsx(e.Fragment,{children:e.jsx(re,{visible:o,toggle:r,loading:t,current:c,onSubmit:s,has_permission:l})}),{PAYMENT_METHOD:A,EDIT:ce}=P,me=({refetch:o,paymentMethod:r,has_permission:c,bool:t,toggle:s})=>{const{callAxios:l,toggle:n,bool:m}=y(),{details:g}=W(`${A}/${r.id}${ce}`),x=d=>{n(),l({method:"put",data:d,url:`${A}/${r.id}`}).then(E=>{E&&(s(),o(),N({message:E.message}))})};return e.jsx(e.Fragment,{children:e.jsx(S,{loading:m,bool:t,current:g,toggle:s,onSubmit:x,has_permission:c})})},{PAYMENT_METHOD:de}=P,he=({refetch:o,has_permission:r,bool:c,toggle:t,memoizehandleCreate:s})=>{const{callAxios:l,bool:n,toggle:m}=y(),g=x=>{m(),l({method:"post",data:x,url:de}).then(d=>{d&&(o(),t(),s(!1),N({message:d.message}))})};return e.jsx(e.Fragment,{children:e.jsx(S,{loading:n,bool:c,toggle:t,onSubmit:g,has_permission:r})})},{NAME:f,DELETE:ue,_PAYMENT_METHOD:ge}=i,xe=({total:o,loading:r,listing:c=[],handleClick:t,handleConfirm:s,has_permission:l})=>{const{onChange:n,getParams:m}=O(""),{page:g,pageSize:x}=m(),d=u.useMemo(()=>[{key:f,title:f,sorter:!0,dataIndex:"name",sortDirections:["descend","ascend"]},{key:"x",width:50,dataIndex:"",title:"",align:"center",render:a=>a.deletable===1&&e.jsx(X,{data:a,handleClick:t,handleConfirm:s,canEdit:a.platform_type==="books",deletePermission:a.platform_type==="books"?l:!1,title:l&&a.platform_type==="books"?`${ue} "${a.name}" ${ge} ?`:"Permission Denied"})}],[t,s,l]),E={onChange:(a,M)=>{console.log(`selectedRowKeys: ${a}`,"selectedRows: ",M)},getCheckboxProps:a=>({disabled:a.name==="Disabled User",name:a.name})};return e.jsx(e.Fragment,{children:e.jsx(q,{bordered:!0,loading:r,onChange:n,dataSource:c,columns:d,rowSelection:{type:"checkbox",...E,columnWidth:30},pagination:{total:o,current:g,pageSize:x,size:"small",showTotal:()=>e.jsx(b,{children:e.jsx(D.Title,{level:5,code:!0,children:`Total:  ${o}`})}),showLessItems:!0,position:["topRight"],showSizeChanger:!0,pageSizeOptions:["10","20","30","50"]},rowKey:a=>a.id})})},{PAYMENT_METHOD:Ee}=P,Pe=()=>{const{bool:o,handleConfirm:r}=y(),[,c]=u.useTransition(),{checkPermission:t}=Z(),{bool:s,toggle:l}=J(),[n,m]=u.useState(!1),{total:g,getParams:x,setTotal:d}=O(""),[E,a]=u.useState(),{has_PaymentModeView_permission:M}=t("PaymentModeView"),{has_PaymentModeEdit_permission:F}=t("PaymentModeEdit"),{has_PaymentModeCreate_permission:H}=t("PaymentModeCreate"),{has_PaymentModeDelete_permission:w}=t("PaymentModeDelete"),{data:h={},isLoading:Y,refetch:T}=Q(x(),{refetchOnMountOrArgChange:!0,skip:!M});u.useEffect(()=>{d(h==null?void 0:h.total)},[d,h==null?void 0:h.total]);const z=p=>{a(p),c(()=>{l()})},I=u.useCallback(p=>r(p,Ee,T),[]),L=u.useCallback(z,[]),j=u.useCallback(()=>m(!n),[n]),R=()=>m(!0);return e.jsxs(e.Fragment,{children:[e.jsx(ae,{closeModal:R}),n&&e.jsx(he,{bool:n,refetch:T,toggle:j,memoizehandleCreate:j,has_permission:H}),M?e.jsx(xe,{total:g,listing:(h==null?void 0:h.data)||[],handleClick:L,loading:o||Y,handleConfirm:I,has_permission:w}):e.jsx($,{}),s&&Object.keys(E).length>0&&e.jsx(me,{toggle:l,bool:s,refetch:T,has_permission:F,paymentMethod:E})]})};export{Pe as default};
