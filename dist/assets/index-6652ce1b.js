import{F as A,j as e,M,n as o,$ as X,a4 as Z,R as O,A as g,D as C,S as j,B as b,p as G,I as T,u as N,ab as B,h as D,l as E,r as p,aa as ee,f as V,G as v,co as K,J as W,s as H,T as f,E as se,cp as te,aw as ne}from"./index-4b3d7bc8.js";import{u as oe}from"./useTabs-bacf39f5.js";import{A as y}from"./AccessDenied-45b92511.js";import{c as ae}from"./capitalize-cfd5966b.js";import{A as Q}from"./ActionMenu-149e95aa.js";import{u as J}from"./usePermissions-36032956.js";import{u as Y}from"./useSearchParam-ebfda256.js";const{enter_name:ce}=G,{AiOutlineUser:le}=T,ie={account_group_name:"",account_type:"Sales"},re=({bool:a,toggle:n,loading:c,onSubmit:l,has_permission:r})=>{const[i]=A.useForm(),d=()=>i.resetFields();return e.jsx(M,{open:a,footer:null,destroyOnClose:!0,onCancel:n,style:{top:0},maskClosable:!1,afterClose:d,title:`${o.CREATE} ${o.ACCOUNT}`,children:r?e.jsxs(A,{name:`${o.ENTER}-${o.ACCOUNT}`,initialValues:ie,form:i,layout:"vertical",onFinish:l,children:[e.jsx(X,{children:e.jsx(Z,{offset:1,span:18,children:e.jsx(A.Item,{colon:!1,labelAlign:"left",label:"Group Type",name:"account_type",labelCol:{span:8},tooltip:"Select Group Type",children:e.jsxs(O.Group,{children:[e.jsx(O,{value:"Sales",children:"Sales"}),e.jsx(O,{value:"Purchase",children:"Purchase"})]})})})}),e.jsx(g,{size:"middle",label:o.NAME,name:"account_group_name",LeftIcon:e.jsx(le,{}),rules:C({message:ce}),placeholder:`${o.ENTER} ${o.NAME}`}),e.jsxs(j,{className:"steps-action",children:[e.jsx(b,{type:"default",htmlType:"button",clickHandler:n,btnText:o.CANCEL}),e.jsx(b,{block:!0,btnText:o.CREATE,style:{width:"120px"},loading:c})]})]}):e.jsx(y,{})})},{ACCOUNT_GROUP:ue}=E,de=({bool:a,toggle:n,refetch:c,has_permission:l})=>{const{callAxios:r}=N(),[i,,d,s]=B(),m=x=>{d(),r({method:"post",data:x,url:ue}).then(u=>{s(),u&&(n==null||n(),c(),D({message:u.message}))})};return e.jsx(e.Fragment,{children:e.jsx(re,{bool:a,toggle:n,loading:i,onSubmit:m,has_permission:l})})},{NAME:R,DELETE:me,_ACCOUNT_GROUP:xe,TYPE:S}=o,he=({loading:a,listing:n=[],handleConfirm:c,has_permission:l})=>{const r=p.useMemo(()=>[{key:R,title:R,dataIndex:"name",ellipsis:!0},{key:S,title:S,dataIndex:"type",width:200,ellipsis:!0,render:s=>e.jsx(ee,{autoCapitalize:"",color:s==="sales"?"green":"blue",children:ae(s)},s)},{key:"x",width:90,dataIndex:"",title:"",align:"center",render:s=>s.deletable===1&&e.jsx(Q,{data:s,canEdit:!1,handleConfirm:c,deletePermission:s.platform_type==="books"?l:!1,title:l&&s.platform_type==="books"?`${me} "${s.name}" ${xe} ?`:" Permission Denied"})}],[c,l]),i={onChange:(s,m)=>{console.log(`selectedRowKeys: ${s}`,"selectedRows: ",m)},getCheckboxProps:s=>({disabled:s.name==="Disabled User",name:s.name})},d=(s,m,x,u)=>{console.log("params",x,u)};return e.jsx(e.Fragment,{children:e.jsx(V,{bordered:!0,loading:a,onChange:d,dataSource:n,columns:r,rowSelection:{type:"checkbox",...i,columnWidth:30},pagination:{showLessItems:!0,showSizeChanger:!0,showQuickJumper:!0,hideOnSinglePage:!0,pageSizeOptions:["10","20","30","50"]},rowKey:s=>s.id})})},{Title:Ce}=f,{ACCOUNT_GROUP:Ae}=E,{MdAccountBox:pe,VscAdd:je}=T,{NEW_ACCOUNT:_e,_ACCOUNT_GROUP:ge}=o,be=()=>{const{bool:a,toggle:n}=v(),{checkPermission:c}=J(),{handleConfirm:l,bool:r}=N(),{has_AccountView_permission:i}=c("AccountView"),{has_AccountCreate_permission:d}=c("AccountCreate"),{has_AccountDelete_permission:s}=c("AccountDelete"),{data:m=[{}],isLoading:x,refetch:u}=K("",{refetchOnMountOrArgChange:!0,skip:!i}),t=p.useCallback(h=>l(h,Ae,u),[]);return e.jsxs(e.Fragment,{children:[e.jsx(W,{title:e.jsxs(j,{children:[e.jsx(pe,{size:25}),e.jsx(Ce,{level:3,children:ge})]}),extra:[e.jsx(H,{icon:e.jsx(je,{size:14}),className:"pr-color",onClick:n,children:_e},"1")],style:{borderBottom:"1px solid gray",paddingBottom:"0"}}),i?e.jsx(he,{listing:m||[],loading:x||r,handleConfirm:t,has_permission:s}):e.jsx(y,{}),e.jsx(de,{bool:a,toggle:n,refetch:u,has_permission:d})]})},{AiOutlineUser:Te,HiOutlineCurrencyDollar:L}=T,{enter_account_name:Ne,enter_account_group:Ee,enter_opening_balance:fe,enter_current_balance:ye}=G,Oe={account_title:"",account_group_id:[],opening_balance:"",current_balance:""},Ue=({bool:a,toggle:n,loading:c,onSubmit:l,has_permission:r})=>{const[i]=A.useForm(),d=()=>i.resetFields(),{data:s=[{}]}=K(""),m=(s==null?void 0:s.map(({id:x,name:u})=>({id:x,label:u})))||[];return e.jsx(M,{title:`${o.CREATE} ${o.ACCOUNT}`,open:a,footer:null,destroyOnClose:!0,onCancel:n,style:{top:0},maskClosable:!1,afterClose:d,children:r?e.jsxs(A,{name:`${o.ENTER}-${o.ACCOUNT}`,initialValues:Oe,form:i,layout:"vertical",onFinish:l,children:[e.jsx(g,{size:"middle",name:"account_title",label:o._ACCOUNT_NAME,LeftIcon:e.jsx(Te,{}),rules:C({message:Ne})}),e.jsx(se,{options:m,className:"flex_root",name:"account_group_id",label:o._ACCOUNT_GROUP,placeholder:"Select Account Group",rules:C({message:Ee})}),e.jsx(g,{size:"middle",name:"opening_balance",label:o.OPENING_BALANCE,LeftIcon:e.jsx(L,{size:17}),rules:C({message:fe})}),e.jsx(g,{size:"middle",name:"current_balance",label:o.CURRENT_BALANCE,LeftIcon:e.jsx(L,{size:17}),rules:C({message:ye})}),e.jsxs(j,{className:"steps-action",children:[e.jsx(b,{type:"default",htmlType:"button",clickHandler:n,btnText:o.CANCEL}),e.jsx(b,{loading:c,btnText:o.CREATE,style:{width:"120px"}})]})]}):e.jsx(y,{})})},{ACCOUNT_NAME:$e}=E,ke=({bool:a,toggle:n,refetch:c,has_permission:l})=>{const{callAxios:r}=N(),[i,,d,s]=B(),m=x=>{d(),r({method:"post",data:x,url:$e}).then(u=>{s(),u&&(n(),c(),D({message:u.message}))})};return e.jsx(e.Fragment,{children:e.jsx(Ue,{bool:a,toggle:n,loading:i,onSubmit:m,has_permission:l})})},{Text:U}=f,{NAME:$,DELETE:we,GROUP:F,OPENING_BALANCE:z,CURRENT_BALANCE:I}=o,Pe=({total:a,loading:n,listing:c=[],handleConfirm:l,has_permission:r})=>{const{onChange:i,getParams:d}=Y(""),{page:s,pageSize:m}=d(),x=p.useMemo(()=>[{key:$,title:$,dataIndex:"title",ellipsis:!0},{key:F,title:F,dataIndex:"account_group",width:200,ellipsis:!0,render:t=>e.jsxs(U,{children:[" ",(t==null?void 0:t.name)||""," "]})},{key:z,title:z,dataIndex:"opening_balance",width:160,render:t=>e.jsxs(U,{children:[" $",t," "]})},{key:I,title:I,dataIndex:"current_balance",width:160,render:t=>e.jsxs(U,{children:[" $",t," "]})},{key:"x",width:50,dataIndex:"",title:"",align:"center",render:t=>t.deletable===1&&e.jsx(Q,{data:t,handleConfirm:l,canEdit:!1,deletePermission:t.platform_type==="books"?r:!1,title:r&&t.platform_type==="books"?`${we} "${t.title}" ${$} ?`:"Permission Denied"})}],[l,r]),u={onChange:(t,h)=>{console.log(`selectedRowKeys: ${t}`,"selectedRows: ",h)},getCheckboxProps:t=>({disabled:t.name==="Disabled User",name:t.name})};return e.jsx(e.Fragment,{children:e.jsx(V,{bordered:!0,loading:n,onChange:i,dataSource:c,columns:x,rowSelection:{type:"checkbox",...u,columnWidth:30},pagination:{total:a,current:s,pageSize:m,size:"small",showTotal:()=>e.jsx(j,{children:e.jsx(f.Title,{level:5,code:!0,children:`Total:  ${a}`})}),showLessItems:!0,position:["topRight"],showSizeChanger:!0,pageSizeOptions:["10","20","30","50"]},rowKey:t=>t.id})})},{Title:Re}=f,{ACCOUNT_NAME:Se}=E,{MdAccountBox:Le,VscAdd:Fe}=T,{NEW_ACCOUNT:ze,_ACCOUNT_NAME:Ie}=o,Me=()=>{var w,P;const{bool:a,toggle:n}=v(),{checkPermission:c}=J(),{handleConfirm:l,bool:r}=N(),{total:i,getParams:d,setTotal:s}=Y(""),{has_AccountView_permission:m}=c("AccountView"),{has_AccountCreate_permission:x}=c("AccountCreate"),{has_AccountDelete_permission:u}=c("AccountDelete"),{data:t={},isLoading:h,refetch:k}=te(d(),{refetchOnMountOrArgChange:!0,skip:!m});p.useEffect(()=>{var _;s((_=t==null?void 0:t.accounts)==null?void 0:_.total)},[s,(w=t==null?void 0:t.accounts)==null?void 0:w.total]);const q=p.useCallback(_=>l(_,Se,k),[]);return e.jsxs(e.Fragment,{children:[e.jsx(W,{title:e.jsxs(j,{children:[e.jsx(Le,{size:25}),e.jsx(Re,{level:3,children:Ie})]}),extra:[e.jsx(H,{icon:e.jsx(Fe,{size:14}),className:"pr-color",onClick:n,children:ze},"1")],style:{borderBottom:"1px solid gray",paddingBottom:"0"}}),m?e.jsx(Pe,{total:i,loading:h||r,handleConfirm:q,listing:((P=t==null?void 0:t.accounts)==null?void 0:P.data)||[],has_permission:u}):e.jsx(y,{}),e.jsx(ke,{bool:a,toggle:n,refetch:k,has_permission:x})]})},Ge=[{key:"1",label:"Account Group",children:e.jsx(be,{})},{key:"2",label:"Account Name",children:e.jsx(Me,{})}],Be=({current:a,handleChange:n})=>e.jsx(e.Fragment,{children:e.jsx(ne,{tabPosition:"left",activeKey:a,items:Ge,onChange:n})}),Je=()=>{const{current:a,handleChange:n}=oe();return e.jsx(e.Fragment,{children:e.jsx(Be,{handleChange:n,current:a})})};export{Je as default};
