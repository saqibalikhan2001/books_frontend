import{e as c,F as l,i as ae,r as o,G as le,ai as te,j as e,$ as t,a4 as a,A as Y,D as oe,aA as C,E as ne,al as r,T as I,ap as N,bU as F,S as de,B as O,n as R,ak as ie,o as re,p as ce,l as me}from"./index-4b3d7bc8.js";import{P as xe}from"./PaginateSelect-b668bdaf.js";import{I as _e}from"./ItemTable-c0313657.js";const{TextArea:v}=ie,{SALES_ORDERS:he}=re,{customer_notes:pe,terms_and_conditions:je}=ce,{SALES_ORDERS_CONTACT:fe,SALES_ORDERS_ITEMS:be}=me,M=c(new Date),ue={name:"",reference:"",adjustment:0,customer_id:null,customer_note:"",sales_order_no:"",shipping_charge:0,order_date:M,terms_and_condition:"",expected_shipment_date:M},Te=({url:k,loading:L,onSubmit:w,handleTotal:B,handleItemList:P,handleWarehouseId:V,handlePrimaryWarehouse:m})=>{var h,p,j,f,b,u,S,y,g;const[n]=l.useForm(),$=ae(),[z,U]=o.useState(0),[q,G]=o.useState([]),[i,H]=o.useState(0),{bool:W,setTrue:X,setFalse:x}=le(!0),{taxList:J,warehouses:K,sales_person:Q,details:s,details:{sales_order_no:_}}=te(k),Z=l.useWatch("adjustment",n),ee=l.useWatch("shipping_charge",n);o.useEffect(()=>{n.setFieldsValue({sales_order_no:_})},[_]),o.useEffect(()=>{var d,T,D,E,A;s!=null&&s.sales_order&&((d=Object.keys(s==null?void 0:s.sales_order))!=null&&d.length)&&(n.setFieldsValue({...s==null?void 0:s.sales_order,order_date:c((T=s==null?void 0:s.sales_order)==null?void 0:T.order_date,"YYYY-MM-DD"),expected_shipment_date:c((D=s==null?void 0:s.sales_order)==null?void 0:D.expected_shipment_date,"YYYY-MM-DD")}),m((E=s==null?void 0:s.sales_order)==null?void 0:E.warehouse_id),G((A=s==null?void 0:s.sales_order)==null?void 0:A.sales_order_details),x())},[s==null?void 0:s.sales_order]),o.useEffect(()=>{B(i)},[i]);const se=o.useCallback(d=>U(d),[]);return e.jsx(e.Fragment,{children:e.jsxs(l,{form:n,name:"item-form",layout:"vertical",autoComplete:"off",onFinish:w,initialValues:ue,children:[e.jsx(t,{children:e.jsx(a,{span:7,offset:1,children:e.jsx(xe,{setTrue:X,name:"customer_id",setFalse:x,label:"Customer Name",url:fe,placeholder:"Select or Search Customer"})})}),e.jsxs("div",{className:W?"hide":"display",children:[e.jsxs(t,{children:[e.jsxs(a,{span:6,offset:1,children:[e.jsx(Y,{name:"sales_order_no",size:"middle",label:"SalesOrder#",rules:oe({message:"SalesOrder# Required!"}),disabled:!0}),e.jsx(l.Item,{name:"order_date",label:"SalesOrder Date",className:"flex_root",children:e.jsx(C,{name:"order_date",format:"YYYY-MM-DD"})})]}),e.jsxs(a,{span:6,offset:1,children:[e.jsx(Y,{name:"reference",size:"middle",label:"Reference"}),e.jsx(l.Item,{name:"expected_shipment_date",label:"Expiry Date",className:"flex_root",children:e.jsx(C,{name:"expected_shipment_date",format:"YYYY-MM-DD"})})]})]}),e.jsx(t,{children:e.jsx(a,{span:6,offset:1,children:e.jsx(ne,{label:"Salesperson",name:"sales_person_id",className:"flex_root",rules:[],loading:!1,options:Q,placeholder:"Select or Add Salesperson"})})}),e.jsx(_e,{sales:!0,taxes:J,itemList:q,warehouses:K,adjustment:Z,url:be,handleSubTotal:se,setTotalAmount:H,handleItemList:P,shipping_charge:ee,handleWarehouseId:V,currency:(h=s==null?void 0:s.base_currency)==null?void 0:h.symbol,edit:s&&((p=Object.keys(s))==null?void 0:p.length),handlePrimaryWarehouse:m}),e.jsx(r,{}),e.jsxs(t,{children:[e.jsx(a,{span:8,offset:1,children:e.jsx(l.Item,{label:"Customer Notes",name:"customer_note",className:"mb flex_root",children:e.jsx(v,{rows:1,placeholder:pe})})}),e.jsxs(a,{span:8,offset:4,children:[e.jsxs(t,{children:[e.jsx(a,{children:e.jsx(I.Title,{level:5,style:{marginTop:8},children:"Sub Total"})}),e.jsx(a,{offset:14,children:e.jsx(N,{value:z,prefix:(j=s==null?void 0:s.base_currency)==null?void 0:j.symbol})})]}),e.jsx(t,{children:e.jsx(a,{children:e.jsx(l.Item,{label:"Adjustment",name:"adjustment",colon:!1,children:e.jsx(F,{name:"adjustment",addonAfter:(f=s==null?void 0:s.base_currency)==null?void 0:f.symbol,placeholder:`${(b=s==null?void 0:s.base_currency)==null?void 0:b.symbol}0.00`})})})}),e.jsx(t,{children:e.jsx(a,{children:e.jsx(l.Item,{label:"Shipping Charges",name:"shipping_charge",colon:!1,children:e.jsx(F,{min:0,name:"shipping_charge",addonAfter:(u=s==null?void 0:s.base_currency)==null?void 0:u.symbol,placeholder:`${(S=s==null?void 0:s.base_currency)==null?void 0:S.symbol}0.00`})})})})]})]}),e.jsx(r,{}),e.jsxs(t,{children:[e.jsx(a,{offset:13,children:e.jsx(I.Title,{level:4,style:{marginTop:3},children:"Total"})}),e.jsx(a,{offset:5,children:e.jsx(N,{value:i,prefix:(y=s==null?void 0:s.base_currency)==null?void 0:y.symbol})})]}),e.jsx(r,{}),e.jsx(t,{children:e.jsx(a,{span:10,offset:1,children:e.jsx(l.Item,{label:"Terms & Conditions",name:"terms_and_condition",className:"flex_root",children:e.jsx(v,{rows:4,name:"terms_and_condition",placeholder:je})})})}),e.jsx(t,{children:e.jsx(a,{offset:1,children:e.jsxs(de,{style:{paddingLeft:"10px"},children:[e.jsx(O,{btnText:s!=null&&s.sales_order&&((g=Object.keys(s==null?void 0:s.sales_order))!=null&&g.length)?R.UPDATE:R.CREATE,style:{width:"120px"},loading:L,block:!0}),e.jsx(O,{type:"default",btnText:"Cancel",htmlType:"button",clickHandler:()=>$(he)})]})})})]})]})})};export{Te as S};
