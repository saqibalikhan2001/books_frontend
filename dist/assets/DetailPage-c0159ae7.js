import{u as ce,U as f,r as u,j as e,al as Ns,H as w,V as hs,W as _s,T as y,I as js,h as le,M as vs,e as te,F as O,G as $s,ay as F,an as g,aj as de,B as ps,y as ys,f as ws,l as ne,n as E,aa as K,aw as Y,i as fs,O as Ts,o as re,a3 as ks,J as bs,a0 as me,a1 as ue,ak as gs,av as Es,ax as Is,ah as Ss}from"./index-4b3d7bc8.js";import{u as Cs}from"./usePermissions-36032956.js";import{c as P}from"./capitalize-cfd5966b.js";import{T as C}from"./Table-9972bb2a.js";import{P as Ds}from"./Processing-a1197381.js";const{Title:$,Text:T}=y,{TfiDownload:xe,MdOutlineFileUpload:Fs,RiDeleteBinLine:Ps}=js,As=({details:s,setUploading:c,supplier:d=!1,isModal:r=!1})=>{var b,U;const{callAxios:l}=ce(),{created_by_platform:m}=f(),[x,k]=u.useState([]),o=(b=s==null?void 0:s.contact_addresses)==null?void 0:b.find(n=>n.address_type==="billing"),i=(U=s==null?void 0:s.contact_addresses)==null?void 0:U.find(n=>n.address_type==="shipping");u.useEffect(()=>{k(s==null?void 0:s.attachments)},[s]);const A=n=>{c(!0),l({url:`/contacts/attachment/${n}`,method:"delete"}).then(a=>{le({message:a==null?void 0:a.message}),k(x==null?void 0:x.filter(_=>(_==null?void 0:_.id)!==n)),c(!1)})},D=n=>{c(!0),l({url:`/contacts/${n}/download-attachment`}).then(a=>{const _=document.createElement("a");_.href=a==null?void 0:a.file,_.download=`${a==null?void 0:a.name}.${a==null?void 0:a.type}`,_.click(),c(!1)})},H=()=>{c(!0),l({url:`/contacts/${s==null?void 0:s.id}/download-all`}).then(n=>{const a=document.createElement("a");a.href=n==null?void 0:n.file,a.download=`${n==null?void 0:n.name}.${n==null?void 0:n.type}`,a.click(),c(!1)})},B=n=>{c(!0);const a=new FormData;a.append("subjectId",s==null?void 0:s.id),a.append("name",s==null?void 0:s.display_name),a.append("files[0]",n.target.files[0]),l({url:"/contacts/attachments",method:"post",data:a}).then(_=>{le({message:_==null?void 0:_.message}),k([...x,_==null?void 0:_.data[0]]),c(!1)})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"product_details",children:[e.jsxs("div",{className:"product_row w-48",children:[e.jsx("div",{className:"product_key",children:e.jsx($,{level:5,children:d?"Supplier":"Customer"})}),e.jsx("div",{className:"product_value",children:e.jsx(T,{children:s==null?void 0:s.display_name})})]}),e.jsxs("div",{className:"product_row w-48",children:[e.jsx("div",{className:"product_key",children:e.jsx($,{level:5,children:"Billing address"})}),e.jsx("div",{className:"product_value",children:e.jsxs(T,{children:[(o==null?void 0:o.street)&&`${o==null?void 0:o.street}, `,(o==null?void 0:o.street_2)&&`${o==null?void 0:o.street_2}, `,(o==null?void 0:o.zip_code)&&`${o==null?void 0:o.zip_code}, `,(o==null?void 0:o.city)&&`${o==null?void 0:o.city}, `,(o==null?void 0:o.country_name)&&`${o==null?void 0:o.country_name}`]})})]}),e.jsxs("div",{className:"product_row w-48",children:[e.jsx("div",{className:"product_key",children:e.jsx($,{level:5,children:"Email"})}),e.jsx("div",{className:"product_value",children:e.jsx(T,{children:s==null?void 0:s.email})})]}),!d&&e.jsxs("div",{className:"product_row w-48",children:[e.jsx("div",{className:"product_key",children:e.jsx($,{level:5,children:"Shipping address"})}),e.jsx("div",{className:"product_value",children:e.jsxs(T,{children:[(i==null?void 0:i.street)&&`${i==null?void 0:i.street}, `,(i==null?void 0:i.street_2)&&`${i==null?void 0:i.street_2}, `,(i==null?void 0:i.zip_code)&&`${i==null?void 0:i.zip_code}, `,(i==null?void 0:i.city)&&`${i==null?void 0:i.city}, `,(i==null?void 0:i.country_name)&&`${i==null?void 0:i.country_name}`]})})]}),e.jsxs("div",{className:"product_row w-48",children:[e.jsx("div",{className:"product_key",children:e.jsx($,{level:5,children:"Phone"})}),e.jsx("div",{className:"product_value",children:e.jsx(T,{children:s==null?void 0:s.work_phone})})]}),e.jsxs("div",{className:"product_row w-48",children:[e.jsx("div",{className:"product_key",children:e.jsx($,{level:5,children:"Payment terms"})}),e.jsx("div",{className:"product_value",children:e.jsx(T,{children:s==null?void 0:s.payment_term_name})})]}),e.jsxs("div",{className:"product_row w-48",children:[e.jsx("div",{className:"product_key",children:e.jsx($,{level:5,children:"Mobile"})}),e.jsx("div",{className:"product_value",children:e.jsx(T,{children:s==null?void 0:s.mobile})})]}),e.jsxs("div",{className:"product_row w-48",children:[e.jsx("div",{className:"product_key",children:e.jsx($,{level:5,children:"Payment method"})}),e.jsx("div",{className:"product_value",children:e.jsx(T,{children:s==null?void 0:s.payment_mode_name})})]}),e.jsxs("div",{className:"product_row w-48",children:[e.jsx("div",{className:"product_key",children:e.jsx($,{level:5,children:"Other"})}),e.jsx("div",{className:"product_value",children:e.jsx(T,{children:s==null?void 0:s.other_contacts})})]}),e.jsxs("div",{className:"product_row w-48",children:[e.jsx("div",{className:"product_key",children:e.jsx($,{level:5,children:"Company Name"})}),e.jsx("div",{className:"product_value",children:e.jsx(T,{children:s==null?void 0:s.company_name})})]}),e.jsxs("div",{className:"product_row w-48",children:[e.jsx("div",{className:"product_key",children:e.jsx($,{level:5,children:"Website"})}),e.jsx("div",{className:"product_value",children:e.jsx(T,{children:s==null?void 0:s.website})})]}),e.jsxs("div",{className:"product_row w-48",children:[e.jsx("div",{className:"product_key",children:e.jsx($,{level:5,children:"Customer language"})}),e.jsx("div",{className:"product_value",children:e.jsx(T,{children:"English (US)"})})]})]}),e.jsx(Ns,{style:{margin:0}}),e.jsxs("div",{className:"product_row w-100 attachment_detail",style:{flexDirection:"column",display:"flex"},children:[e.jsxs("div",{className:"product_row w-100",children:[e.jsx("div",{className:"product_key",children:e.jsx($,{level:5,children:"Attachments"})}),e.jsxs("div",{className:"product_value image_attachment",children:[(s==null?void 0:s.platform_type)==="books"&&!r&&e.jsxs("label",{htmlFor:"myfile",children:[e.jsx(w,{title:"Upload",children:e.jsx(Fs,{size:20})}),e.jsx("input",{type:"file",id:"myfile",name:"myfile",style:{display:"none"},onChange:B})]}),(x==null?void 0:x.length)>0&&!r&&e.jsx(w,{title:"Download All",children:e.jsx(xe,{size:18,onClick:H})})]})]}),e.jsx("div",{className:"w-100 attachment_gallery",style:{flexDirection:"row",display:"flex"},children:x==null?void 0:x.map((n,a)=>e.jsxs("div",{className:"attachement_image",children:[e.jsx(hs,{preview:!1,style:{width:100,height:100},src:["png","jpg","jpeg","webp"].includes(n==null?void 0:n.attachment_type)?_s(n==null?void 0:n.attachment,m):"https://s3-us-west-2.amazonaws.com/ims-development/static/media/file.png"}),!r&&e.jsxs("div",{className:"image_icon_overlay",children:[e.jsx(w,{title:"Download",children:e.jsx(xe,{size:18,onClick:()=>D(n==null?void 0:n.id)})}),(s==null?void 0:s.is_attachment_deletable)&&e.jsx(w,{title:"Delete",children:e.jsx(Ps,{size:20,onClick:()=>A(n==null?void 0:n.id)})})]})]},a))})]})]})},Rs=({pdf:s,isModalOpen:c,setIsModalOpen:d})=>{const r=()=>{d(!1)};return e.jsx(vs,{footer:null,destroyOnClose:!0,width:1e3,title:"PDF Viewer",open:c,onCancel:r,className:"category_modal",centered:!0,children:e.jsx("object",{data:`data:application/pdf;base64,${s}`,type:"application/pdf",style:{width:"100%",height:"75vh"},"aria-label":"pdf"})})},{Title:L,Text:I}=y,se=te(new Date),{CUSTOMERS_STATEMENT:he}=ne,{DATE:_e,TRANSACTION:je,DETAILS:pe,AMOUNT:ye,PAYMENTS:Ne,BALANCE:ve}=E,Os=({url:s,name:c,setEmail:d,supplier:r,setIsDate:l,isModal:m=!1})=>{var z,J,q,Q,X,Z,G;const[x]=O.useForm(),{callAxios:k}=ce(),{bool:o,toggle:i}=$s(),{org_date_format:A}=f(),[D,H]=u.useState(),[B,b]=u.useState(!0),[U,n]=u.useState(!1),[a,_]=u.useState(),t=F(O.useWatch("to",x)),W=F(O.useWatch("from",x));u.useEffect(()=>{k({url:`${s}${he}?starting_date=${`${F(se)} 00:00:00`}&ending_date=${`${F(se)} 23:59:59`}`}).then(j=>{b(!1),_(j)}),x.setFieldsValue({from:te(F(se)),to:te(F(se))})},[s,x]);const N=()=>{k({url:`${s}/pdf?starting_date=${`${W} 00:00:00`}&ending_date=${`${t} 23:59:59`}&download=true`}).then(j=>{const p=document.createElement("a");p.href=j,p.download=`${c} Statement.pdf`,p.click()})},M=()=>{k({url:`${s}/pdf?starting_date=${`${W} 00:00:00`}&ending_date=${`${t} 23:59:59`}`}).then(j=>{H(j),n(!0)})},R=j=>{b(!0);const p=F(j.from),v=F(j.to);i(),k({url:`${s}${he}?starting_date=${`${p} 00:00:00`}&ending_date=${`${v} 23:59:59`}`}).then(ee=>{i(),_(ee),b(!1)})},ae=u.useMemo(()=>[{title:_e,dataIndex:"date",key:_e,width:90,ellipsis:!0,render:j=>g(j,A)},{title:je,dataIndex:"transaction",key:je,width:103,ellipsis:!0},{title:pe,dataIndex:"details",key:pe,width:90,ellipsis:!0},{title:ye,dataIndex:"",key:ye,width:80,ellipsis:!0,render:j=>{var p,v;return e.jsxs(y,{children:[e.jsx(w,{placement:"topLeft",title:(p=a==null?void 0:a.base_currency)==null?void 0:p.name,children:e.jsx(I,{children:(v=a==null?void 0:a.base_currency)==null?void 0:v.symbol})}),`${j.total}`]})}},{title:Ne,dataIndex:"",key:Ne,width:90,ellipsis:!0,render:j=>{var p,v;return e.jsxs(y,{children:[e.jsx(w,{placement:"topLeft",title:(p=a==null?void 0:a.base_currency)==null?void 0:p.name,children:e.jsx(I,{children:(v=a==null?void 0:a.base_currency)==null?void 0:v.symbol})}),`${j.payments}`]})}},{title:ve,dataIndex:"",key:ve,width:80,ellipsis:!0,render:j=>{var p,v;return e.jsxs(y,{children:[e.jsx(w,{placement:"topLeft",title:(p=a==null?void 0:a.base_currency)==null?void 0:p.name,children:e.jsx(I,{children:(v=a==null?void 0:a.base_currency)==null?void 0:v.symbol})}),`${j.balance}`]})}}],[A,a]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"__report_tabs_align mb-30",children:[e.jsx(O,{form:x,onFinish:R,className:"date_picker_form",children:e.jsxs("div",{className:"flexbox  justify-content-between",children:[e.jsxs("div",{className:"form_group flex-47",children:[e.jsx("label",{children:"From"}),e.jsx(de,{name:"from",format:A,disabled:m})]}),e.jsxs("div",{className:"form_group flex-47",children:[e.jsx("label",{children:"To"}),e.jsx(de,{name:"to",format:A,disabled:m})]}),e.jsx(ps,{loading:o,disabled:m,btnText:"Run report",className:"btn-primary h-36px ml-15"})]})}),!m&&e.jsxs("div",{className:"account_receipt d-flex",children:[e.jsx(w,{placement:"bottom",title:"pdf",children:e.jsx("img",{src:"https://s3-us-west-2.amazonaws.com/ims-development/static/media/PDF.svg",alt:"",onClick:N})}),e.jsx(w,{placement:"bottom",title:"print",children:e.jsx("img",{src:"https://s3-us-west-2.amazonaws.com/ims-development/static/media/Print.svg",alt:"",onClick:M})}),e.jsx(w,{placement:"bottom",title:"mail",children:e.jsx("img",{src:"https://ims-development.s3.us-west-2.amazonaws.com/static/media/email.svg",alt:"",onClick:()=>{l({to:t,from:W,url:!0}),d(!0)}})})]})]}),B?e.jsx(ys,{}):e.jsxs("div",{children:[e.jsx(y.Title,{level:4,className:"main_heading",children:"Statement Summary"}),e.jsxs("div",{className:"summary_list",children:[e.jsxs("div",{className:"product_row w-100",children:[e.jsx("div",{className:"product_key",children:e.jsx(L,{level:5,children:"Opening balance"})}),e.jsx("div",{className:"product_value",children:e.jsxs(I,{children:[(z=a==null?void 0:a.base_currency)==null?void 0:z.symbol,a==null?void 0:a.openingBalance]})})]}),!r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"product_row w-100",children:[e.jsx("div",{className:"product_key",children:e.jsx(L,{level:5,children:"Total credit sales"})}),e.jsx("div",{className:"product_value",children:e.jsxs(I,{children:[(J=a==null?void 0:a.base_currency)==null?void 0:J.symbol,a==null?void 0:a.creditSales]})})]}),e.jsxs("div",{className:"product_row w-100 divider",children:[e.jsx("div",{className:"product_key",children:e.jsx(L,{level:5,children:"Total credit notes"})}),e.jsx("div",{className:"product_value",children:e.jsxs(I,{children:[(q=a==null?void 0:a.base_currency)==null?void 0:q.symbol,a==null?void 0:a.creditNotes]})})]})]}),e.jsxs("div",{className:"product_row w-100 ",children:[e.jsx("div",{className:"product_key",children:e.jsx(L,{level:5,children:r?"Net credit purchases":"Net credit sales"})}),e.jsx("div",{className:"product_value",children:e.jsxs(I,{children:[(Q=a==null?void 0:a.base_currency)==null?void 0:Q.symbol,r?a==null?void 0:a.totalAmount:a==null?void 0:a.creditNetSales]})})]}),e.jsxs("div",{className:"product_row w-100 divider",children:[e.jsx("div",{className:"product_key",children:e.jsx(L,{level:5,children:r?"Total payments made":"Total payments received"})}),e.jsx("div",{className:"product_value",children:e.jsxs(I,{children:[(X=a==null?void 0:a.base_currency)==null?void 0:X.symbol,a==null?void 0:a.totalPaid]})})]}),e.jsxs("div",{className:"product_row w-100 divider",children:[e.jsx("div",{className:"product_key",children:e.jsx(L,{level:5,children:"Closing balance"})}),e.jsx("div",{className:"product_value",children:e.jsxs(I,{children:[(Z=a==null?void 0:a.base_currency)==null?void 0:Z.symbol,a==null?void 0:a.totalDue]})})]})]}),e.jsx(y.Title,{level:4,className:"main_heading",children:"Statement Detail"}),e.jsx(ws,{bordered:!1,rowKey:"key",pagination:!1,columns:ae,dataSource:a==null?void 0:a.statement,className:"generic-table no-radius"}),e.jsxs("div",{className:"product_row  closing_balance",children:[e.jsx("div",{className:"product_key",children:e.jsx(L,{level:5,children:"Closing balance"})}),e.jsx("div",{className:"product_value",children:e.jsxs(I,{children:[(G=a==null?void 0:a.base_currency)==null?void 0:G.symbol,a==null?void 0:a.totalDue]})})]})]}),U&&e.jsx(Rs,{isModalOpen:U,setIsModalOpen:n,pdf:D})]})},{DATE:$e,BILL_NO:we,DUE:fe,AMOUNT:Te,STATUS:ke}=E,Us=({url:s})=>{const{org_date_format:c}=f(),d=u.useMemo(()=>[{title:$e,dataIndex:"bill_date",key:$e,width:80,ellipsis:!0,render:r=>g(r,c)},{title:we,dataIndex:"bill_no",key:we,width:100,ellipsis:!0},{title:fe,dataIndex:"balance_due",key:fe,width:100,ellipsis:!0,render:(r,l)=>{var m;return e.jsx(e.Fragment,{children:`${(m=l==null?void 0:l.currency)==null?void 0:m.symbol}${r.toFixed(2)}`})}},{title:Te,dataIndex:"total",key:Te,width:100,ellipsis:!0,render:(r,l)=>{var m;return e.jsx(e.Fragment,{children:`${(m=l==null?void 0:l.currency)==null?void 0:m.symbol}${r.toFixed(2)}`})}},{title:ke,dataIndex:"status",key:ke,width:100,ellipsis:!0,render:r=>e.jsx(K,{autoCapitalize:"",className:`generic-bagde ${r==="partially paid"?"partially-paid":r}`,children:P(r==="partially paid"?"PRTL Paid":r)},r)}],[]);return e.jsx(C,{rowKey:"bill_no",columns:d||[],url:`${s}?filter=bills`})},{DATE:be,INVOICE_NO:ge,PAYMENT_DUE:Ee,AMOUNT:Ie,STATUS:Se}=E,Ms=({url:s})=>{const{org_date_format:c}=f(),d=u.useMemo(()=>[{title:be,dataIndex:"due_date",key:be,width:80,ellipsis:!0,render:r=>g(r,c)},{title:ge,dataIndex:"invoice_no",key:ge,width:100,ellipsis:!0},{title:Ee,dataIndex:"payment_due",key:Ee,width:95,ellipsis:!0,render:(r,l)=>{var m;return e.jsx(e.Fragment,{children:`${(m=l==null?void 0:l.currency)==null?void 0:m.symbol}${r.toFixed(2)}`})}},{title:Ie,dataIndex:"total",key:Ie,width:80,ellipsis:!0,render:(r,l)=>{var m;return e.jsx(e.Fragment,{children:`${(m=l==null?void 0:l.currency)==null?void 0:m.symbol}${r.toFixed(2)}`})}},{title:Se,dataIndex:"status",key:Se,width:110,ellipsis:!0,render:r=>e.jsx(K,{className:`generic-bagde ${r==="partially paid"?"partially-paid":r}`,autoCapitalize:"",children:P(r==="partially paid"?"PRTL Paid":r)},r)}],[]);return e.jsx(C,{rowKey:"invoice_no",columns:d,url:`${s}?filter=invoices`})},{DATE:Ce,PACKAGE_NO:De,STATUS:Fe}=E,zs=({url:s})=>{const{org_date_format:c}=f(),d=u.useMemo(()=>[{title:Ce,dataIndex:"package_date",key:Ce,width:80,ellipsis:!0,render:r=>g(r,c)},{title:De,dataIndex:"package_no",key:De,width:100,ellipsis:!0},{title:Fe,dataIndex:"status",key:Fe,width:110,ellipsis:!0,render:r=>e.jsx(K,{autoCapitalize:"",className:`generic-bagde ${r==="not shipped"?"not-shipped":r}`,children:P(r)},r)}],[]);return e.jsx(C,{rowKey:"package_no",columns:d,url:`${s}?filter=packages`})},{DATE:Pe,SALES_ORDER_NO:Ae,REFERENCE:Re,AMOUNT:Oe,STATUS:Ue}=E,Ls=({url:s})=>{const{org_date_format:c}=f(),d=u.useMemo(()=>[{title:Pe,dataIndex:"order_date",key:Pe,width:80,ellipsis:!0,render:r=>g(r,c)},{title:Ae,dataIndex:"sales_order_no",key:Ae,width:125,ellipsis:!0},{title:Re,dataIndex:"reference",key:Re,width:95,ellipsis:!0},{title:Oe,dataIndex:"total",key:Oe,width:80,ellipsis:!0,render:(r,l)=>{var m;return e.jsx(e.Fragment,{children:`${(m=l==null?void 0:l.currency)==null?void 0:m.symbol}${r.toFixed(2)}`})}},{title:Ue,dataIndex:"status",key:Ue,width:110,ellipsis:!0,render:r=>e.jsx(K,{className:`generic-bagde ${r}`,autoCapitalize:"",children:P(r)},r)}],[]);return e.jsx(C,{columns:d,rowKey:"sales_order_no",url:`${s}?filter=sales_orders`})},{DATE:Me,SALES_RETURN:ze,ADD_TO_STOCK:Le,QUANTITY:Ke,STATUS:Be}=E,Ks=({url:s})=>{const{org_date_format:c}=f(),d=u.useMemo(()=>[{title:Me,dataIndex:"sales_return_date",key:Me,width:80,ellipsis:!0,render:r=>g(r,c)},{title:ze,dataIndex:"sales_return_no",key:ze,width:100,ellipsis:!0},{title:Le,dataIndex:"back_stock",key:Le,width:100,ellipsis:!0},{title:Ke,dataIndex:"add_back_stock",key:Ke,width:100,ellipsis:!0},{title:Be,dataIndex:"sales_return_status",key:Be,width:100,ellipsis:!0,render:r=>e.jsx(K,{autoCapitalize:"",className:`generic-bagde ${r==="closed"?"received":r}`,children:P(r==="closed"?"received":r)},r)}],[]);return e.jsx(C,{columns:d,rowKey:"sales_return_no",url:`${s}?filter=sales_return`})},{DATE:Ve,CREDIT_NOTE:Ye,INVOICE:He,CREDIT:We,STATUS:Qe}=E,Bs=({url:s})=>{const{org_date_format:c}=f(),d=u.useMemo(()=>[{title:Ve,dataIndex:"credit_note_date",key:Ve,width:80,ellipsis:!0,render:r=>g(r,c)},{title:Ye,dataIndex:"credit_note_no",key:Ye,width:100,ellipsis:!0},{title:He,dataIndex:"invoice_no",key:He,width:100,ellipsis:!0},{title:We,dataIndex:"issued_credits",key:We,width:100,ellipsis:!0,render:(r,l)=>e.jsx(e.Fragment,{children:`${l==null?void 0:l.symbol}${r.toFixed(2)}`})},{title:Qe,dataIndex:"status",key:Qe,width:100,ellipsis:!0,render:r=>e.jsx(K,{className:`generic-bagde ${r==="partially applied"?"partially-applied":r}`,autoCapitalize:"",children:P(r==="partially applied"?"PRTL Applied":r)},r)}],[]);return e.jsx(C,{rowKey:"credit_note_no",columns:d,url:`${s}?filter=credit_notes`})},{DATE:Ge,TYPE:Je,REFERENCE:qe,AMOUNT:Xe}=E,Vs=({url:s})=>{const{org_date_format:c}=f(),d=u.useMemo(()=>[{title:Ge,dataIndex:"payment_date",key:Ge,width:80,ellipsis:!0,render:r=>g(r,c)},{title:qe,dataIndex:"reference",key:qe,width:100,ellipsis:!0},{title:Xe,dataIndex:"amount",key:Xe,width:100,ellipsis:!0,render:(r,l)=>{var m;return e.jsx(e.Fragment,{children:`${(m=l==null?void 0:l.currency)==null?void 0:m.symbol}${r.toFixed(2)}`})}},{title:Je,dataIndex:"payment_mode",key:Je,width:100,ellipsis:!0}],[c]);return e.jsx(C,{rowKey:"id",columns:d,url:`${s}?filter=payments_made`})},{DATE:Ze,PURCHASE_ORDER_NO:es,REFERENCE:ss,AMOUNT:ts,STATUS:as}=E,Ys=({url:s})=>{const{org_date_format:c}=f(),d=u.useMemo(()=>[{title:Ze,dataIndex:"order_date",key:Ze,width:95,ellipsis:!0,render:r=>g(r,c)},{title:es,dataIndex:"purchase_order_no",key:es,width:115,ellipsis:!0},{title:ss,dataIndex:"reference",key:ss,width:90,ellipsis:!0},{title:ts,dataIndex:"total",key:ts,width:90,ellipsis:!0,render:(r,l)=>{var m;return e.jsx(e.Fragment,{children:`${(m=l==null?void 0:l.currency)==null?void 0:m.symbol}${r.toFixed(2)}`})}},{title:as,dataIndex:"status",key:as,width:90,ellipsis:!0,render:r=>e.jsx(K,{autoCapitalize:"",className:`generic-bagde ${r}`,children:P(r)},r)}],[]);return e.jsx(C,{columns:d,rowKey:"purchase_order_no",url:`${s}?filter=purchase_orders`})},{DATE:rs,PURCHASE_ORDER_NO:ls,QUANTITY:cs,RECEIVE_NO:ns}=E,Hs=({url:s})=>{const{org_date_format:c}=f(),d=u.useMemo(()=>[{title:rs,dataIndex:"receive_date",key:rs,width:80,ellipsis:!0,render:r=>g(r,c)},{title:ns,dataIndex:"receive_no",key:ns,width:100,ellipsis:!0},{title:ls,dataIndex:"purchase_order_no",key:ls,width:100,ellipsis:!0},{title:cs,dataIndex:"received_quantity",key:cs,width:100,ellipsis:!0}],[]);return e.jsx(C,{rowKey:"receive_no",columns:d,url:`${s}?filter=purchase_receives`})},{DATE:is,PAYMENT_NO:os,REFERENCE:ds,AMOUNT:ms,TYPE:us}=E,Ws=({url:s})=>{const{org_date_format:c}=f(),d=u.useMemo(()=>[{title:is,dataIndex:"created_at",key:is,width:100,ellipsis:!0,render:r=>g(r,c)},{title:os,dataIndex:"payment_no",key:os,width:100,ellipsis:!0},{title:ds,dataIndex:"reference",key:ds,width:90,ellipsis:!0},{title:ms,dataIndex:"payment_made",key:ms,width:90,ellipsis:!0,render:(r,l)=>{var m;return e.jsx(e.Fragment,{children:`${(m=l==null?void 0:l.currency)==null?void 0:m.symbol}${r.toFixed(2)}`})}},{title:us,dataIndex:"payment_mode",key:us,width:120,ellipsis:!0}],[]);return e.jsx(C,{rowKey:"payment_no",columns:d,url:`${s}?filter=payments_received`})},{TRANSACTIONS:S}=ne,Qs=({url:s,contact_type:c})=>{const d=u.useMemo(()=>[{key:"1",label:"Sales Orders",children:e.jsx(e.Fragment,{children:e.jsx(Ls,{url:`${s}${S}`})})},{key:"2",label:"Invoices",children:e.jsx(e.Fragment,{children:e.jsx(Ms,{url:`${s}${S}`})})},{key:"3",label:"Packages",children:e.jsx(e.Fragment,{children:e.jsx(zs,{url:`${s}${S}`})})},{key:"4",label:"Payments Received",children:e.jsx(e.Fragment,{children:e.jsx(Ws,{url:`${s}${S}`})})},{key:"5",label:"Sales Return",children:e.jsx(e.Fragment,{children:e.jsx(Ks,{url:`${s}${S}`})})},{key:"6",label:"Credit Notes",children:e.jsx(e.Fragment,{children:e.jsx(Bs,{url:`${s}${S}`})})}],[s]),r=u.useMemo(()=>[{key:"1",label:"Purchase Orders",children:e.jsx(e.Fragment,{children:e.jsx(Ys,{url:`${s}${S}`})})},{key:"2",label:"Purchase Receives",children:e.jsx(e.Fragment,{children:e.jsx(Hs,{url:`${s}${S}`})})},{key:"3",label:"Bills",children:e.jsx(e.Fragment,{children:e.jsx(Us,{url:`${s}${S}`})})},{key:"4",label:"Payments Made",children:e.jsx(e.Fragment,{children:e.jsx(Vs,{url:`${s}${S}`})})}],[s]);return e.jsx(Y,{className:"transaction-tab-inner",items:c==="customer"?d:r,defaultActiveKey:"1"})},{RiQuestionFill:xs}=js,{CUSTOMERS:V,ACTIVITY:Gs}=ne,Js=te(new Date),tt=({detail:s,setFalse:c,isModal:d=!1,loading:r=!1,supplier:l=!1,handleConfirm:m})=>{var G,j,p,v,ee,ie,oe;const[x]=O.useForm(),k=fs(),{callAxios:o,toggle:i,bool:A}=ce(),[D,H]=u.useState(!1),[B,b]=u.useState(!1),{created_by_platform:U}=f(),{checkPermission:n}=Cs(),[a,_]=u.useState(!1),[t,W]=u.useState(),N=JSON.parse(Ts("obj")),{has_ContactDelete_permission:M}=n("ContactDelete"),[R,ae]=u.useState({to:"",from:"",url:!1}),z=F(Js),J=O.useWatch("note",x);u.useEffect(()=>{(s!=null&&s.id||N!=null&&N.curr_id)&&(i(),o({url:`${V}/${(s==null?void 0:s.id)??(N==null?void 0:N.curr_id)}`}).then(h=>{W(h),c==null||c(!1),x.setFieldValue("note",h==null?void 0:h.note)}))},[s==null?void 0:s.id,N==null?void 0:N.curr_id]),u.useEffect(()=>{b(!1)},[N==null?void 0:N.curr_id]);const q=()=>{H(!D),D&&o({url:`/contacts/${t==null?void 0:t.id}/contact_note`,method:"put",data:{notes:J}}).then(h=>{i(),le({message:h==null?void 0:h.message})})},Q=()=>b(!B),X=[{key:"0",label:"Clone",onClick:()=>k(`${l?re.SUPPLIER_CLONE:re.CUSTOMER_CLONE}?id=${t==null?void 0:t.id}`)},{key:"1",label:"Email",onClick:Q},{key:"2",label:e.jsx(ks,{placement:"left",disabled:!((t==null?void 0:t.platform_type)==="books"&&M),title:`Are you sure you want to delete "${t==null?void 0:t.display_name}"?`,okText:(t==null?void 0:t.platform_type)==="books"&&M?"YES":"OK",cancelText:"No",showCancel:(t==null?void 0:t.platform_type)==="books"&&M,onCancel:h=>h==null?void 0:h.stopPropagation(),onConfirm:h=>{h==null||h.stopPropagation(),(t==null?void 0:t.platform_type)==="books"&&(m==null||m(t))},children:e.jsx(w,{title:"Delete",children:e.jsx("label",{style:{cursor:(t==null?void 0:t.platform_type)==="books"&&M?"pointer":"not-allowed",width:"100%",display:"block"},onClick:h=>h==null?void 0:h.stopPropagation(),children:"Delete"})})},"confirm"),disabled:!((t==null?void 0:t.platform_type)==="books"&&M)}],Z=[{key:"0",label:"Invoice",disabled:!0},{key:"1",label:"Credit note",disabled:!0},{key:"2",label:"Bill",disabled:!0},{key:"3",label:"Vendor credit",disabled:!0}];return e.jsx(e.Fragment,{children:r||A?e.jsx(ys,{}):e.jsxs("div",{style:d?{}:{animation:"fadeInRight",animationDuration:"0.5s",opacity:a?.5:1,pointerEvents:a?"none":"auto"},children:[e.jsx(bs,{className:" __items_details_header",title:t==null?void 0:t.display_name,extra:d?[]:[e.jsxs("div",{className:"__items_details_actions d-flex",children:[e.jsx(me.Button,{menu:{items:X},trigger:["click"],icon:e.jsx(ue,{}),className:"mr-10 btn-edit",disabled:(t==null?void 0:t.platform_type)!=="books",onClick:()=>k(`${re.EDIT_CUSTOMER}?id=${t==null?void 0:t.id}`),children:"Edit"}),e.jsx(me,{menu:{items:Z},trigger:["click"],children:e.jsxs("div",{className:"btn-primary btn-trascation",children:["New transaction",e.jsx(ue,{})]})})]})],footer:e.jsx(e.Fragment,{children:e.jsxs("div",{className:"__items-details_container ",children:[e.jsxs("div",{className:"product-details d-flex",children:[e.jsx("div",{className:"product-details-left img_holder",children:e.jsx(hs,{className:"customer-dp",preview:!1,src:t!=null&&t.photo?_s(t==null?void 0:t.photo,U):"https://s3-us-west-2.amazonaws.com/ims-development/media/default-user-image-placeholder.svg"})}),e.jsx("div",{className:"customer-liscence-note",children:e.jsxs("div",{className:"internal_fixer",children:[e.jsxs("div",{className:"product-details-center mb-30",children:[e.jsx(y.Text,{className:"stock-heading",children:"License number"}),e.jsx(y.Text,{className:"stock-dues",children:t!=null&&t.license_no&&(t==null?void 0:t.license_no)!=="null"?t==null?void 0:t.license_no:"Not Allocated"})]}),e.jsxs("div",{className:"product-details-right",children:[e.jsxs("div",{className:"d-flex product_note",children:[e.jsx(y.Text,{className:"mb-5 details-notes",children:"Notes"}),e.jsx(ps,{type:"link",clickHandler:q,btnText:D?"Save":"Edit",className:D?"save_btn":"edit_btn",disabled:(t==null?void 0:t.platform_type)!=="books"||d})]}),e.jsx(O,{form:x,children:e.jsx(O.Item,{name:"note",children:e.jsx(gs.TextArea,{disabled:!D,rows:4})})})]})]})}),e.jsxs("div",{className:"product_arrangement",children:[e.jsxs("div",{className:"product-details-center mb-30",children:[e.jsxs(y.Text,{className:"stock-heading",children:["Current balance",e.jsx(w,{placement:"bottom",title:"tooltip here",children:e.jsx(xs,{})})]}),e.jsxs(y.Text,{className:"stock-dues",children:[(G=t==null?void 0:t.currency)==null?void 0:G.symbol,l?(p=(j=t==null?void 0:t.transaction_summary)==null?void 0:j.total_payable)==null?void 0:p.toFixed(2):(ee=(v=t==null?void 0:t.transaction_summary)==null?void 0:v.total_receivable)==null?void 0:ee.toFixed(2)]})]}),e.jsxs("div",{className:"product-details-center mb-30",children:[e.jsx(y.Text,{className:"stock-heading",children:"Overdue"}),e.jsxs(y.Text,{className:"stock-dues",children:[(ie=t==null?void 0:t.currency)==null?void 0:ie.symbol,(oe=t==null?void 0:t.over_due)==null?void 0:oe.toFixed(2)]})]}),e.jsxs("div",{className:"product-details-center",children:[e.jsxs(y.Text,{className:"stock-heading",children:["Origin",e.jsx(w,{placement:"bottom",title:`This ${l?"supplier":"customer"} is created from ${P(t==null?void 0:t.platform_type)} origin`,children:e.jsx(xs,{})})]}),e.jsx(y.Text,{className:"stock-dues",children:P(t==null?void 0:t.platform_type)})]})]})]}),a&&e.jsx(Ds,{})]})})}),B?e.jsx(Es,{setEmail:b,handleEmail:Q,emailUrl:R.url?`${V}${R.url?"/statement":""}/${t==null?void 0:t.id}/mail/${`${R.from?R.from:z} 00:00:00`}/${`${R.to?R.to:z} 23:59:59`}`:`${V}/${t==null?void 0:t.id}/mail?starting_date=${`${z} 00:00:00`}&ending_date=${`${z} 23:59:59`}`}):e.jsx("div",{className:"__items-details_container transaction-tab-main",children:e.jsxs(Y,{onChange:Is,defaultActiveKey:"1",children:[e.jsx(Y.TabPane,{tab:e.jsx("label",{className:"detail_tab_label",children:`${l?"Supplier":"Customer"} details`}),children:e.jsx(As,{details:t,isModal:d,supplier:l,setUploading:_})},"1"),e.jsx(Y.TabPane,{tab:e.jsx("label",{className:"detail_tab_label",children:"Transactions"}),children:e.jsx(Qs,{url:`${V}/${t==null?void 0:t.id}`,contact_type:t==null?void 0:t.contact_type})},"2"),e.jsx(Y.TabPane,{tab:e.jsx("label",{className:"detail_tab_label",children:"Account statement"}),children:e.jsx(Os,{isModal:d,supplier:l,setEmail:b,setIsDate:ae,name:t==null?void 0:t.display_name,url:`${V}/${t==null?void 0:t.id}`})},"3"),e.jsx(Y.TabPane,{tab:e.jsx("label",{className:"detail_tab_label",children:"Activity log"}),children:e.jsx(Ss,{url:`${V}/${t==null?void 0:t.id}${Gs}`})},"5")]})})]})})};export{tt as D,Rs as P};
