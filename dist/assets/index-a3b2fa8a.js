import{i as V,u as G,r as o,v as J,w as K,N as Q,O as q,h as W,z as p,t as X,j as e,y as Y,B as Z,l as ee,o as se}from"./index-4b3d7bc8.js";import{D as ne}from"./DetailPage-c0159ae7.js";import{S as A,C as te}from"./Listing-ebb0bf80.js";import{u as oe}from"./useCustomPagination-4b61827d.js";import{u as ie}from"./usePermissions-36032956.js";import{u as ae}from"./useDetailPageProps-fa80b790.js";import{A as le}from"./AccessDenied-45b92511.js";import{A as re}from"./index-9f4b88aa.js";import{E as ce}from"./DetailPlusListingHeader-5d7935e9.js";import"./capitalize-cfd5966b.js";import"./Table-9972bb2a.js";import"./Processing-a1197381.js";import"./ActionMenu-149e95aa.js";import"./react-beautiful-dnd.esm-fdc0d50f.js";const{CUSTOMERS:me}=ee,{EDIT_CUSTOMER:de}=se,ye=()=>{var v,y;const x=V(),{bool:O,callAxios:D,toggle:I}=G(),[j,m]=o.useState(!1),{checkPermission:M}=ie(),[t,c]=o.useState([]),{has_ContactView_permission:C}=M("ContactView"),{paginate:i,handlePagination:d,Next:F}=oe("contacts"),{getCurrentModule:T,checkModulePermission:z}=J(),{status:u=void 0}=T("contact")||{},{detail:B,setbool:R,fullScreen:r,bool:b,handleFullScreen:g,memoizeHandleClick:$}=ae(),S=K(n=>n.sidebarReducer),{data:s,refetch:f,isFetching:k}=Q({paginate:i,sidebarPosition:S},{refetchOnMountOrArgChange:!0,skip:!C||z("contact")});o.useEffect(()=>(window.addEventListener("beforeunload",E),()=>{window.removeEventListener("beforeunload",E)}),[]);const E=()=>{const n={...i,page:1};localStorage.setItem("params",JSON.stringify(n))};o.useEffect(()=>{d({...i,page:1})},[]),o.useEffect(()=>{var n;i.page===1?(c(s==null?void 0:s.contacts.data),m(!1)):(c([...t,...(n=s==null?void 0:s.contacts)==null?void 0:n.data]),m(!1))},[s==null?void 0:s.contacts.data]);const H=()=>{d({...i,page:1,sort:"asc",sort_column:"display_name",filter:"",searchByAlphabet:"",current_balance:"",start_range:"",end_range:""})},L=n=>{p(n==null?void 0:n.id,!0,"/customers"),x(`${de}?id=${n.id}`)},U=o.useCallback(L,[x]),_=o.useCallback(n=>{const a=JSON.parse(q("obj")),h=t.findIndex(l=>(l==null?void 0:l.id)===(n==null?void 0:n.id));I(),D({method:"delete",url:`${me}/${n.id}`}).then(l=>{var P,N,w;l&&(W({message:l.message}),f(),t.length>1?(console.log(" products.length > 1"),p((P=t[h+1])!=null&&P.id?(N=t[h+1])==null?void 0:N.id:(w=t[h-1])==null?void 0:w.id,a!=null&&a.once?a==null?void 0:a.once:!1,"/customers",null,null)):(console.log("else"),p("",!1,"/customers",null,null),X(g),c([])))})},[t,f]);return e.jsx(e.Fragment,{children:C?e.jsx(e.Fragment,{children:O||!j&&k?e.jsx(Y,{}):((t==null?void 0:t.length)||((y=(v=s==null?void 0:s.contacts)==null?void 0:v.data)==null?void 0:y.length))>0?e.jsx("div",{className:"customer_detail_listing",children:e.jsxs(e.Fragment,{children:[!u&&e.jsx(re,{showIcon:!0,type:"info",message:"Module Permissions",description:"Please Enable Module Permissions To See Details"}),!r&&e.jsx(A,{enable:!u}),e.jsxs("div",{className:r?"scrollbar_container":"",children:[!b&&e.jsx("div",{className:r?"list":"full_screen",children:(s==null?void 0:s.contacts)&&e.jsx(te,{next:F,listing:s,loader:j,refetch:f,products:t,loading:k,pagination:i,setLoader:m,showDetail:r,setProducts:c,handleClick:U,setparam:d,handleConfirm:_,sidebarPosition:S,handleFullScreen:g,handleViewClick:$})}),r&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"content_side",children:(s==null?void 0:s.contacts)&&e.jsx(ne,{detail:B,loading:b,setFalse:R,handleConfirm:_,handleFullScreen:g})})})]})]})}):e.jsxs(e.Fragment,{children:[e.jsx(A,{enable:!u}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"600px",flexDirection:"column"},children:[e.jsx(ce,{}),e.jsx("span",{children:"No data found"}),e.jsx(Z,{type:"link",btnText:"Go Back",clickHandler:H})]})]})}):e.jsx(le,{})})};export{ye as default};
