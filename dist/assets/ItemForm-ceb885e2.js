import{F as d,u as ne,r as j,j as e,R as B,H as f,A as t,B as G,T as u,I as te,h as oe,l as re,i as Fe,aW as Oe,U as Be,G as De,ai as Ge,W as ee,o as de,y as Le,a2 as $e,E,n as a,S as v,V as D,M as Ke,D as S,s as Me,_ as Ve,ak as y,p as h,az as ce}from"./index-4b3d7bc8.js";import{I as qe}from"./ImageCrop-db92a92e.js";import{U as He}from"./ImageUploader-b2d6894b.js";import{A as We}from"./index-d9b76a87.js";import{U as Ye}from"./index-b8658cbe.js";const{Text:se}=u,{RiQuestionFill:le}=te,{NUMBER_PREFERENCES:Xe,SKU:Qe}=re,Je=({detail:c})=>{const[g]=d.useForm(),{callAxios:C,toggle:_,bool:I}=ne();j.useEffect(()=>{var m,x;g.setFieldsValue({skuTerms:c==null?void 0:c.terms,skuFormat:(m=c==null?void 0:c.preferences)==null?void 0:m.skuFormat,startFrom:(x=c==null?void 0:c.preferences)==null?void 0:x.startFrom})},[g,c]);const k=m=>{_(),C({method:"put",url:`${Xe}${Qe}`,data:{...m}}).then(x=>{x&&oe({message:x.message})}).catch(()=>_())};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"_container sku_form main_wrapper",children:e.jsx(d,{form:g,layout:"vertical",onFinish:k,children:e.jsxs("div",{className:"form_box",children:[e.jsx(d.Item,{className:"mb-10",colon:!1,name:"skuTerms",labelAlign:"left",label:e.jsx("label",{children:"SKU"}),children:e.jsxs(B.Group,{defaultValue:"auto",children:[e.jsx("div",{className:"radio_group",children:e.jsxs(B,{value:"auto",className:"align_label",children:[e.jsx(se,{children:"Auto generate SKU Number"}),e.jsx(f,{placement:"right",title:"This option will auto-generate the SKU. User can also provide the prefix (optional)",children:e.jsx(le,{size:16})})]})}),e.jsx("div",{className:"radio_group",children:e.jsxs(B,{value:"manual",className:"align_label",children:[e.jsx(se,{children:"Continue from last SKU Number"}),e.jsx(f,{placement:"right",title:"The SKU on latest products will be generated by incrementing the latest SKU in existing products list. Best suitable when importing products list to SeeBiz Books",children:e.jsx(le,{size:16})})]})})]})}),e.jsxs("div",{className:"flexbox mb-30",children:[e.jsx("div",{className:"form_group w-100 mb-10",children:e.jsx(t,{type:"text",size:"middle",name:"skuFormat",style:{width:232},className:"input_field",label:e.jsx("label",{children:"SKU Prefix"})})}),e.jsx("div",{className:"form_group w-100",children:e.jsx(t,{disabled:!0,type:"text",size:"middle",name:"startFrom",style:{width:232},className:"input_field",label:e.jsx("label",{children:"SKU Start From"})})})]}),e.jsx("div",{className:"_sku_actions",children:e.jsx(G,{btnText:"Save",loading:I,className:"w-90 h-36 btn-form-size btn-primary text-center"})})]})})})})},{ITEMS:Ze}=de,{GET_SKU:es}=re,{Option:ae,OptGroup:ie}=ce,{AiOutlineSetting:ss,RiDeleteBinLine:ls,VscClose:as}=te,is=[{id:"Inventory",label:"Inventory"}],ns={sku:"",upc:"",ean:"",mpn:"",isbn:"",unit:"",name:"",notes:"",brand:"",weight:"",dimensions:"",description:"",reorder_level:0,opening_stock:0,category_id:null,manufacturer:"",type:"Inventory",upload_images:"",sales_unit_price:0,sales_description:"",sales_account_id:null,opening_stock_value:0,purchase_unit_price:0,purchase_description:"",purchase_account_id:null},ms=({url:c,edit:g,clone:C,create:_,loading:I,onSubmit:k,fileList:m,isModal:x=!1,setFileList:me,handleTaxType:xe,setAttachList:ue,handleFileList:pe,attachList:U=[],toggleItemModal:A,handleImageList:he,deleteAttachments:je,handleWareshouseList:L,handleTrackInventory:fe,setDeleteAttachments:_e,handleImageAttachList:w})=>{var Y,X;const[p]=d.useForm(),Ne=Fe(),be=Oe(),{callAxios:ge}=ne(),{created_by_platform:$}=Be(),[R,ve]=j.useState(""),{bool:Se,toggle:K}=De(!1),P=j.useRef(null),z=j.useRef(null),F=j.useRef(null),{taxList:O,itemUnits:we,warehouses:M,formLoading:Te,base_currency:i,details:s,account_groups:{sales:V=[],purchase:q=[]}={}}=Ge(c),H=d.useWatch("upload_images",p);j.useEffect(()=>{var l,n,r,N,b,T,Q,J,Z;if(s!=null&&s.item_details&&Object.keys(s==null?void 0:s.item_details).length){const Re=(l=s==null?void 0:s.item_details)==null?void 0:l.images.map((o,ze)=>({uid:ze,name:o,status:"done",old_image:!0,editImage:!0,url:ee(o,$)})),Pe=(n=s==null?void 0:s.item_details)==null?void 0:n.attachments.map(o=>({uid:o==null?void 0:o.id,status:"done",old_image:!0,editAttach:!0,name:o==null?void 0:o.attachment,url:ee(o==null?void 0:o.attachment,$)}));p.setFieldsValue({...s==null?void 0:s.item_details,sku:C?s==null?void 0:s.clone_sku:(r=s==null?void 0:s.item_details)==null?void 0:r.sku,type:((N=s==null?void 0:s.item_details)==null?void 0:N.type)==="goods"?"Inventory":"",currency_code:`${s==null?void 0:s.item_details.currency_code} - ${s==null?void 0:s.item_details.name}`,opening_stock:(T=(b=s==null?void 0:s.item_details)==null?void 0:b.stocks[0])==null?void 0:T.opening_quantity}),(Q=s==null?void 0:s.item_details)!=null&&Q.tax_group_id&&p.setFieldsValue({tax_id:(J=s==null?void 0:s.item_details)==null?void 0:J.tax_group_id}),he(Re),w(Pe),L(s==null?void 0:s.warehouses.filter(o=>o.is_primary)),fe(((Z=s==null?void 0:s.item_details)==null?void 0:Z.inventory_type)==="inventory")}},[s==null?void 0:s.item_details]),j.useEffect(()=>{var l,n,r,N;if(_&&s&&Object.keys(s).length){const b=M.filter(T=>T.is_primary);L(b),p.setFieldsValue({sales_account_id:(n=(l=V[0])==null?void 0:l.accounts[0])==null?void 0:n.id,purchase_account_id:(N=(r=q[0])==null?void 0:r.accounts[0])==null?void 0:N.id})}},[_,s,M]);const Ee=()=>{K(),ge({url:es}).then(l=>{K(),l&&p.setFieldsValue({sku:l.sku||"IMS-100"})})},W=()=>p.setFieldsValue({upload_images:null}),ye=l=>n=>{const r=m.filter((N,b)=>b!==l);me(r)},Ce=({fileList:l})=>{const r=l[l.length-1].size;r!==void 0&&(r<=2e7?w==null||w(l):oe({message:"File must be smaller than 20MB",type:"info"}))},Ie=l=>{const n=O.find(r=>r.id===l&&r.isGroup);xe(n?"group":null)},ke=l=>{g&&l.old_image&&_e([...je,l==null?void 0:l.uid]),ue(U.filter(n=>n.uid!==l.uid))},Ue=()=>{ve(!R)},Ae=l=>{l.errorFields.length&&(P.current!==null&&l.values.name===""?P.current.focus():z.current!==null&&l.values.sku===""?z.current.focus():F.current!==null&&l.values.unit===""&&F.current.focus())};return e.jsx(e.Fragment,{children:Te&&be.pathname!==de.ADD_ITEM&&!x?e.jsx(Le,{}):e.jsxs("div",{className:"main_wrapper container-1280",children:[!x&&e.jsx($e,{name:_?"Create New Product/Service":(Y=s==null?void 0:s.item_details)==null?void 0:Y.name}),e.jsx("div",{className:"_container",children:e.jsxs(d,{form:p,name:"item-form",layout:"vertical",autoComplete:"off",onFinish:k,requiredMark:!1,initialValues:ns,onFinishFailed:Ae,children:[e.jsx(u.Title,{level:4,className:"form_heading",children:"Product Type"}),e.jsx("div",{className:"form_box",children:e.jsx("div",{className:"flexbox form-row-container justify-content-between",children:e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(E,{name:"type",size:"large",options:is,allowClear:!1,className:"input_field",defaultValue:"Inventory",label:e.jsx("label",{children:a.TYPE}),placeholder:a.SELECT_PRODUCT_TYPE})})})}),e.jsx(u.Title,{level:4,className:"form_heading",children:"Product Image"}),e.jsxs("div",{className:"form_box",children:[e.jsx("label",{className:"image_label",children:a.upload_product_image}),e.jsxs("div",{className:"upload-wrapper-main d-flex",children:[e.jsx("div",{className:"upload-wrapper-inner",children:e.jsx("div",{className:"form_box",children:e.jsx("div",{className:"upload_box",children:e.jsx(d.Item,{name:"upload_images",children:e.jsx(He,{fileList:m,prodcutImage:!0,src:"",form:p})})})})}),e.jsx("div",{className:"upload-wrapper-images",children:m.map((l,n)=>e.jsxs(v,{className:"upload-wrapper",children:[e.jsx(v,{className:"anticon",onClick:ye(n),children:e.jsx("div",{children:e.jsx(as,{className:"crossIcon"})})}),e.jsx("div",{children:e.jsx(D,{width:100,height:100,preview:!1,alt:"item here",className:"img_logo",src:l.editImage?l==null?void 0:l.url:URL.createObjectURL(l)})})]}))}),e.jsx(Ke,{width:872,footer:null,destroyOnClose:!0,centered:!0,onCancel:W,open:!!H,title:e.jsx("label",{className:"image-modal-heading",children:"Adjust Image"}),children:e.jsx(qe,{image:H,fileList:m,handleOk:W,handleFileList:pe})})]})]}),e.jsx(u.Title,{level:4,className:"form_heading",children:"Product Name"}),e.jsx("div",{className:"form_box",children:e.jsxs("div",{className:"flexbox form-row-container justify-content-between",children:[e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(t,{name:"name",size:"middle",className:"input_field",label:e.jsxs("label",{children:[a.NAME," ",e.jsx("span",{className:"staric",children:"*"})]}),rules:S({message:h.enter_name}),innerRef:P})}),e.jsxs("div",{className:"form_group flex-47 mb-30 button_flexbox product-sku ",children:[e.jsx(t,{name:"sku",size:"middle",placeholder:"Enter SKU",innerRef:z,className:"input_field need",label:e.jsx(f,{title:"Stop keeping unit",children:e.jsxs("label",{children:[a.SKU," ",e.jsx("span",{className:"staric",children:"*"})]})}),addonAfter:e.jsx(e.Fragment,{children:e.jsx(Me,{className:"btn-form-size btn-primary d-flex align-center btn-generate",style:{color:"white"},loading:Se,onClick:Ee,children:"Generate Sku"})}),rules:S({message:h.sku_required})}),e.jsx("div",{className:"d-flex settings ",children:e.jsx(Ve,{trigger:"click",title:"SKU settings",placement:"rightTop",overlayClassName:" __sku_settings",content:e.jsx(Je,{detail:s==null?void 0:s.sku_prefrence}),children:e.jsx(ss,{size:18,onClick:Ue,className:R===!1?"toggle-false":R===!0?"toggle-true":""})})})]}),e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(d.Item,{name:"description",className:"flex_root",label:e.jsx("label",{children:a.PRODUCT_DESCRIPTION}),children:e.jsx(y.TextArea,{showCount:!0,maxLength:255,rows:4})})}),e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(E,{size:"large",name:"category_id",className:"input_field",options:s==null?void 0:s.category,label:e.jsx("label",{children:a.CATEGORY}),placeholder:a.SELECT_PRODUCT_CATEGORY})})]})}),e.jsx(u.Title,{level:4,className:"form_heading",children:"Product Info"}),e.jsx("div",{className:"form_box",children:e.jsxs("div",{className:"flexbox form-row-container justify-content-between",children:[e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(t,{name:"brand",size:"middle",className:"input_field",placeholder:"Enter brand name",label:e.jsx("label",{children:a.BRAND})})}),e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(d.Item,{name:"unit",className:"input_field custom_field",rules:S({message:h.unit_required}),label:e.jsxs("label",{children:[a.SELLING_UNIT," ",e.jsx("span",{className:"staric",children:"*"})]}),children:e.jsx(We,{showArrow:!0,ref:F,options:we,placeholder:h.select_unit,filterOption:(l,n)=>n.value.toUpperCase().indexOf(l.toUpperCase())===-1})})}),e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(t,{size:"middle",name:"manufacturer",className:"input_field",placeholder:"Enter product manufacturer",label:e.jsx("label",{children:a.MANUFACTURER})})}),e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(t,{name:"upc",size:"middle",className:"input_field",placeholder:"Enter product UPC",label:e.jsx("label",{children:a.UPC_BARCODE})})}),e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(t,{size:"middle",name:"weight",className:"input_field",placeholder:"Enter product weight",label:e.jsx("label",{children:a.WEIGHT})})}),e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(t,{name:"mpn",size:"middle",className:"input_field",placeholder:"Enter product MPN",label:e.jsx("label",{children:a.MPN})})}),e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(t,{size:"middle",name:"dimensions",className:"input_field",placeholder:"Length x Weight x Height",label:e.jsx("label",{children:a.DIMENSIONS})})}),e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(t,{name:"ean",size:"middle",className:"input_field",placeholder:"Enter product EAN",label:e.jsx("label",{children:a.EAN})})}),e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(t,{name:"isbn",size:"middle",className:"input_field",placeholder:"Enter product ISBN",label:e.jsx("label",{children:a.ISBN})})})]})}),e.jsx(u.Title,{level:4,className:"form_heading",children:"Product Quantity"}),e.jsx("div",{className:"form_box",children:e.jsxs("div",{className:"flexbox form-row-container justify-content-between",children:[e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(t,{size:"middle",type:"number",placeholder:"0",name:"opening_stock",style:{width:170},className:"input_field",parser:l=>parseInt(l),label:e.jsx("label",{children:a.INITIAL_QUANTITY})})}),e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(t,{size:"middle",type:"number",placeholder:"0",stringMode:!1,className:"input_field",name:"opening_stock_value",parser:l=>parseInt(l),label:e.jsx("label",{children:a.STOCK_VALUE}),disabled:(X=s==null?void 0:s.item_details)==null?void 0:X.transactionInfo,addonBefore:e.jsx(f,{title:`${i==null?void 0:i.name} (${i==null?void 0:i.currency_code})`,children:i==null?void 0:i.symbol})})}),e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(t,{size:"middle",type:"number",placeholder:"0",stringMode:!1,name:"reorder_level",className:"input_field",label:e.jsx("label",{children:a.REORDER_POINT}),parser:l=>parseInt(l)})})]})}),e.jsx(u.Title,{level:4,className:"form_heading",children:"Product Sales"}),e.jsx("div",{className:"form_box",children:e.jsxs("div",{className:"flexbox form-row-container justify-content-between",children:[e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(d.Item,{className:"flex_root",name:"sales_description",label:e.jsx("label",{children:a.SALES_DESCRIPTION}),children:e.jsx(y.TextArea,{showCount:!0,maxLength:255,rows:4})})}),e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(t,{size:"middle",type:"number",placeholder:"0",stringMode:!1,className:"input_field",name:"sales_unit_price",label:e.jsx("label",{children:a.SELLING_PRICE}),addonBefore:e.jsx(f,{title:`${i==null?void 0:i.name} (${i==null?void 0:i.currency_code})`,children:i==null?void 0:i.symbol})})}),e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(E,{options:V,allowClear:!1,className:"flex_root",name:"sales_account_id",placeholder:h.select_sales_account,label:e.jsx("label",{children:a.INCOME_ACCOUNT}),rules:S({message:h.sales_account_required})})}),e.jsx("div",{className:"form_group flex-47 mb-30 tax-group",children:e.jsx(d.Item,{name:"tax_id",label:e.jsx("label",{children:a.SALES_TAX}),children:e.jsxs(ce,{allowClear:!0,onChange:Ie,placeholder:"Select Tax or Tax group",className:"input_field w-100 custom_field remove-select-icon",children:[e.jsx(ie,{label:e.jsx("label",{children:`${a.TAX}`}),children:O.map((l,n)=>!l.isGroup&&e.jsx(ae,{value:l.id,children:`${l.name} [${l.rate}%]`},n))}),e.jsx(ie,{label:e.jsx("label",{children:`${a.TAX} ${a.GROUP}`}),children:O.map((l,n)=>l.isGroup&&e.jsx(ae,{value:l.id,children:`${l.name} [${l.rate}%]`},n))})]})})})]})}),e.jsx(u.Title,{level:4,className:"form_heading",children:"Product Purchases"}),e.jsx("div",{className:"form_box",children:e.jsxs("div",{className:"flexbox form-row-container justify-content-between",children:[e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(d.Item,{className:"flex_root",name:"purchase_description",label:e.jsx("label",{children:a.PURCHASE_DESCRIPTION}),children:e.jsx(y.TextArea,{showCount:!0,maxLength:255,rows:4})})}),e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(t,{size:"middle",type:"number",placeholder:"0",stringMode:!1,className:"input_field",name:"purchase_unit_price",label:e.jsx("label",{children:a.COST}),addonBefore:e.jsx(f,{title:`${i==null?void 0:i.name} (${i==null?void 0:i.currency_code})`,children:i==null?void 0:i.symbol})})}),e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(E,{options:q,allowClear:!1,className:"flex_root",name:"purchase_account_id",label:e.jsx("label",{children:a.EXPENSE_ACCOUNT}),rules:S({message:h.purchase_account_required})})})]})}),e.jsx(u.Title,{level:4,className:"form_heading",children:"Product Notes"}),e.jsx("div",{className:"form_box",children:e.jsx("div",{className:"flexbox form-row-container justify-content-between",children:e.jsx("div",{className:"form_group flex-47 mb-30",children:e.jsx(d.Item,{name:"notes",className:"flex_root",label:e.jsx("label",{children:a.ADD_NOTES}),children:e.jsx(y.TextArea,{showCount:!0,maxLength:255,rows:4})})})})}),e.jsxs("div",{className:"form_box attachment_gap",children:[e.jsx("label",{className:"image_label",children:a.Attachment}),e.jsxs("div",{style:{display:"flex"},className:" upload-wrapper-master",children:[e.jsx("div",{className:"upload-wrapper-inner",style:{alignSelf:"flex-start"},children:e.jsx(Ye,{fileList:U,showUploadList:!1,listType:"picture-card",onChange:Ce,children:e.jsxs("div",{className:"optimistic",children:[e.jsx("div",{className:"ant-upload-drag-icon",style:{marginBottom:"20px"},children:e.jsx(D,{preview:!1,className:"logo",alt:"attach-logo",src:"https://s3-us-west-2.amazonaws.com/ims-development/static/media/add_product.png"})}),e.jsx("p",{className:"ant-upload-text drag-text",children:"Drag or Upload your attachment"}),e.jsx("p",{className:"ant-upload-hint",children:"Only .JPG, .JPEG, .PNG and .PDF format supported"}),e.jsx("p",{className:"ant-upload-hint",children:"Maximum size: 20 MB"})]})})}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap"},children:U.map(l=>e.jsxs(v,{className:"upload-wrapper image-container",style:{marginLeft:15,marginBottom:15},children:[e.jsx(v,{className:"anticon overlay",children:e.jsx(f,{title:"Delete",children:e.jsx(ls,{className:"delete_icon",onClick:()=>ke(l)})})}),e.jsx(D,{width:100,height:100,preview:!1,alt:"attach here",className:"img_logo",src:l!=null&&l.editAttach?l==null?void 0:l.url:URL.createObjectURL(l==null?void 0:l.originFileObj)})]}))})]})]}),e.jsx("div",{className:"custom_blocklevel",children:e.jsxs(v,{style:{paddingLeft:"10px"},children:[e.jsx(G,{htmlType:"button",btnText:a.CANCEL,className:"btn-default btn-form-size",clickHandler:()=>x?A==null?void 0:A():Ne(Ze)}),e.jsx(G,{block:!0,loading:I,btnText:a.SAVE,className:"btn-form-size btn-primary ml-20"})]})})]})})]})})};export{ms as I};
