import{i as $,k as E,r as c,u as k,j as r,l as L,h as N}from"./index-4b3d7bc8.js";import{C as P}from"./CustomerTab-c6c321f7.js";import{u as R}from"./usePermissions-36032956.js";import{A as T}from"./AccessDenied-45b92511.js";import"./useListing-af775608.js";import"./useDelayUnmount-cb77ae7b.js";import"./index-b8658cbe.js";import"./progress-e3fed29d.js";import"./ImageUploader-b2d6894b.js";const{CUSTOMERS:d}=L,v=()=>{const h=$(),[u]=E(),g=u.get("id"),[_,f]=c.useState([]),{checkPermission:x}=R(),{callAxios:C,toggle:S,bool:b}=k(),[i,p]=c.useState([]),[o,j]=c.useState([]),{has_ContactCreate_permission:y}=x("ContactCreate"),O=c.useCallback(s=>{p(s)},[]),A=s=>{let n={};const m=[],l=[];i.forEach(t=>{t.old_image?l.push(t.url):m.push(t.originFileObj)});let e=new FormData;typeof s.photo=="object"?n={...s}:n={...s,photo:"",cloneUrl:s.photo};for(const t in n)e.append(t,n[t]||"");e.append("contact_type_id","2"),e.append("currency_id",_),e.append("tax_exempt",JSON.stringify(!!s.tax_exempt)),e.append("same_as_billing",JSON.stringify(s.same_as_billing)),o.length>0&&e.append("is_attachment_deleted",JSON.stringify(o.length>0));for(let[t,a]of Object.entries(m))e.append(`attachments[${t}]`,a);for(let[t,a]of Object.entries(o))e.append(`deleted_attachments[${t}]`,a);for(let[t,a]of Object.entries(l))e.append(`clone_attachments[${t}]`,a);S(),C({method:"post",url:`${d}`,data:e}).then(t=>{t&&(N({message:t.message}),h(-1))})};return r.jsx(r.Fragment,{children:y?r.jsx(P,{loading:b,onSubmit:A,attachList:i,setCurrency:f,setAttachList:p,deleteAttachments:o,url:`${d}/${g}/clone`,setDeleteAttachments:j,handleImageAttachList:O}):r.jsx(T,{})})};export{v as default};
