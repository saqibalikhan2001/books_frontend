import{i as P,r as a,u as W,j as p,l as $,h as c,z}from"./index-4b3d7bc8.js";import{I as N}from"./ItemForm-ceb885e2.js";import{u as U}from"./usePermissions-36032956.js";import{A as B}from"./AccessDenied-45b92511.js";import"./ImageCrop-db92a92e.js";import"./ImageUploader-b2d6894b.js";import"./progress-e3fed29d.js";import"./index-d9b76a87.js";import"./index-b8658cbe.js";const{ITEMS:G,ITEMS_CREATE:H}=$,ee=({isModal:d=!1,toggleItemModal:s,itemObj:f,setItemObj:g})=>{const k=P(),[r,x]=a.useState(!0),{checkPermission:y}=U(),{callAxios:b,toggle:T,bool:j}=W(),[L,I]=a.useState(),[_,o]=a.useState([]),[m,u]=a.useState([]),[S,A]=a.useState([]),{has_ItemCreate_permission:C}=y("ItemCreate"),E=a.useCallback(e=>{o(e)},[]),F=a.useCallback(e=>o(e),[]),w=a.useCallback(e=>{u(e)},[]),q=a.useCallback(e=>{A(e)},[]),O=e=>x(e),R=e=>I(e),D=e=>{if(e.opening_stock>0&&e.opening_stock_value<=0)c({message:"Initial quantity on hand field is required",type:"info"});else if(e.opening_stock<=0&&e.opening_stock_value>0)c({message:"Initial quantity on hand field is required",type:"info"});else{let n=new FormData;n.append("sku",e.sku),n.append("upc",e.upc),n.append("mpn",e.mpn),n.append("ean",e.ean),n.append("isbn",e.isbn),n.append("name",e.name),n.append("unit",e.unit),n.append("brand",e.brand),n.append("weight",e.weight),n.append("notes",e.notes||""),n.append("tax_type",L||null),n.append("dimensions",e.dimensions),n.append("tax_id",e.tax_id||null),n.append("category_id",e.category_id),n.append("manufacturer",e.manufacturer),n.append("description",e.description||""),n.append("reorder_level",e.reorder_level||0),n.append("sales_account_id",e.sales_account_id),n.append("sales_unit_price",e.sales_unit_price||0),n.append("purchase_account_id",e.purchase_account_id),n.append("type",e.type==="Inventory"?"goods":""),n.append("sales_description",e.sales_description||""),n.append("purchase_unit_price",e.purchase_unit_price||0),n.append("opening_stock_value",e.opening_stock_value||0),n.append("inventory_type",r?"inventory":"noninventory"),n.append("purchase_description",e.purchase_description||""),n.append("warehouses[0][id]",S[0].id),n.append("warehouses[0][opening_stock]",e.opening_stock);for(let[t,i]of Object.entries(_))n.append(`upload_images[${t}]`,i);for(let[t,i]of Object.entries(m))n.append(`attachments[${t}]`,i.originFileObj);T(),b({method:"post",url:G,data:n}).then(t=>{var i,h,l;t&&(c({message:t.message}),d?(s==null||s(),g({...f,...t==null?void 0:t.data,value:(h=t==null?void 0:t.data)==null?void 0:h.id,label:(l=t==null?void 0:t.data)==null?void 0:l.name})):(z((i=t==null?void 0:t.data)==null?void 0:i.id,!0,"/items"),k(-1)))})}};return p.jsx(p.Fragment,{children:C?p.jsx(p.Fragment,{children:p.jsx(N,{create:!0,loading:j,isModal:d,tracked:r,url:H,fileList:_,onSubmit:D,attachList:m,setFileList:o,setAttachList:u,handleTaxType:R,handleFileList:F,handleImageList:E,toggleItemModal:s,handleTrackInventory:O,handleWareshouseList:q,handleImageAttachList:w})}):p.jsx(B,{})})};export{ee as default};
