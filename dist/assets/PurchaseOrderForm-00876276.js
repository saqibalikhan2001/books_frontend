import{e as m,F as d,i as J,r as o,G as X,ai as K,j as e,$ as t,a4 as a,A as R,n as l,D as Q,E as Z,p as x,aA as A,al as _,T as v,ap as Y,bU as ee,S as se,B as N,ak as ae,o as te,l as le}from"./index-4b3d7bc8.js";import{P as de}from"./PaginateSelect-b668bdaf.js";import{I as oe}from"./ItemTable-c0313657.js";const{TextArea:re}=ae,{PURCHASE_ORDERS:ie}=te,{terms_and_conditions:ne}=x,{PURCHASE_ORDERS_CONTACTS:ce,PURCHASE_ORDERS_ITEMS:_e}=le,C=m(new Date),me={reference:"",adjustment:0,vendor_id:null,shipping_charge:0,warehouse_id:null,purchase_order_no:"",order_date:C,terms_and_condition:"",expected_delivery_date:C},je=({url:g,loading:O,onSubmit:I,handleTotal:F,handleItemList:M})=>{var j,u,f,b,y,E,T;const[i]=d.useForm(),P=J(),[w,U]=o.useState(0),[k,H]=o.useState([]),[c,L]=o.useState(0),{bool:V,setTrue:B,setFalse:h}=X(!0),{taxList:z,warehouses:n,purchaseAccount:W,details:s,details:{purchase_order_no:p}}=K(g),$=d.useWatch("adjustment",i),q=(n==null?void 0:n.find(r=>r.is_primary))||{};o.useEffect(()=>{i.setFieldsValue({purchase_order_no:p,warehouse_id:q.id})},[p]),o.useEffect(()=>{var r,S,D;s!=null&&s.purchase_order_details&&Object.keys(s==null?void 0:s.purchase_order_details).length&&(i.setFieldsValue({...s==null?void 0:s.purchase_order_details,expected_delivery_date:m((r=s==null?void 0:s.purchase_order_details)==null?void 0:r.expected_delivery_date,"YYYY-MM-DD"),order_date:m((S=s==null?void 0:s.purchase_order_details)==null?void 0:S.order_date,"YYYY-MM-DD")}),H((D=s==null?void 0:s.purchase_order_details)==null?void 0:D.purchase_order_item_details),h())},[s==null?void 0:s.purchase_order_details]),o.useEffect(()=>{F(c)},[c]);const G=o.useCallback(r=>U(r),[]);return e.jsx(e.Fragment,{children:e.jsxs(d,{form:i,layout:"vertical",autoComplete:"off",onFinish:I,name:"purchase-order-form",initialValues:me,children:[e.jsx(t,{children:e.jsx(a,{span:7,offset:1,children:e.jsx(de,{setTrue:B,name:"vendor_id",setFalse:h,label:"Vendor Name",url:ce,placeholder:"Select or Search Vendor"})})}),e.jsxs("div",{className:V?"hide":"display",children:[e.jsxs(t,{children:[e.jsxs(a,{span:6,offset:1,children:[e.jsx(R,{disabled:!0,size:"middle",name:"purchase_order_no",label:l.PURCHASE_ORDER_NO,rules:Q({message:x.purchase_order_required})}),e.jsx(Z,{loading:!1,name:"warehouse_id",options:n,className:"flex_root",label:l._WAREHOUSE,placeholder:x.select_warehouse}),e.jsx(d.Item,{name:"order_date",label:"Order Date",className:"flex_root",children:e.jsx(A,{name:"order_date",format:"YYYY-MM-DD"})})]}),e.jsxs(a,{span:6,offset:1,children:[e.jsx(R,{name:"reference",size:"middle",label:l.REFERENCE}),e.jsx(d.Item,{name:"expected_delivery_date",label:l.DELIVERY_DATE,className:"flex_root",children:e.jsx(A,{name:"expected_delivery_date",format:"YYYY-MM-DD"})})]})]}),e.jsx(oe,{purchaseOrder:!0,taxes:z,itemList:k,adjustment:$,url:_e,handleItemList:M,handleSubTotal:G,setTotalAmount:L,purchaseAccount:W,currency:(j=s==null?void 0:s.base_currency)==null?void 0:j.symbol,edit:s&&Object.keys(s).length}),e.jsx(_,{}),e.jsx(t,{children:e.jsxs(a,{span:8,offset:13,children:[e.jsxs(t,{children:[e.jsx(a,{children:e.jsx(v.Title,{level:5,style:{marginTop:8},children:"Sub Total"})}),e.jsx(a,{offset:14,children:e.jsx(Y,{value:w,prefix:(u=s==null?void 0:s.base_currency)==null?void 0:u.symbol})})]}),e.jsx(t,{children:e.jsx(a,{children:e.jsx(d.Item,{label:l.ADJUSTMENT,name:"adjustment",colon:!1,children:e.jsx(ee,{name:"adjustment",addonAfter:(f=s==null?void 0:s.base_currency)==null?void 0:f.symbol,placeholder:`${(b=s==null?void 0:s.base_currency)==null?void 0:b.symbol}0.00`})})})})]})}),e.jsx(_,{}),e.jsxs(t,{children:[e.jsx(a,{offset:13,children:e.jsx(v.Title,{level:4,style:{marginTop:3},children:"Total"})}),e.jsx(a,{offset:5,children:e.jsx(Y,{value:c,prefix:(y=s==null?void 0:s.base_currency)==null?void 0:y.symbol})})]}),e.jsx(_,{}),e.jsx(t,{children:e.jsx(a,{span:10,offset:1,children:e.jsx(d.Item,{label:l.TERMS_AND_CONDITIONS,name:"terms_and_condition",className:"flex_root",children:e.jsx(re,{rows:4,name:"terms_and_condition",placeholder:ne})})})}),e.jsx(t,{children:e.jsx(a,{offset:1,children:e.jsxs(se,{style:{paddingLeft:"10px"},children:[e.jsx(N,{block:!0,loading:O,style:{width:"120px"},btnText:(T=(E=s==null?void 0:s.purchase_order_details)==null?void 0:E.vendor)!=null&&T.display_name?l.UPDATE:l.CREATE}),e.jsx(N,{type:"default",btnText:"Cancel",htmlType:"button",clickHandler:()=>P(ie)})]})})})]})]})})};export{je as P};
