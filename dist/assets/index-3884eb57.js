import{i as E,k as $,r as i,u as k,j as r,l as N,h as P}from"./index-4b3d7bc8.js";import{u as D}from"./usePermissions-36032956.js";import{C as F}from"./CustomerTab-c6c321f7.js";import{A as J}from"./AccessDenied-45b92511.js";import"./useListing-af775608.js";import"./useDelayUnmount-cb77ae7b.js";import"./index-b8658cbe.js";import"./progress-e3fed29d.js";import"./ImageUploader-b2d6894b.js";const{CUSTOMERS:d}=N,v=()=>{const h=E(),[u]=$(),g=u.get("id"),[_,f]=i.useState([]),{checkPermission:x}=D(),{callAxios:b,toggle:S,bool:j}=k(),[c,p]=i.useState([]),[o,y]=i.useState([]),{has_ContactEdit_permission:A}=x("ContactEdit"),C=i.useCallback(s=>{p(s)},[]),O=s=>{let n={};const m=[],l=[];c.forEach(t=>{t.old_image?l.push(t.url):m.push(t.originFileObj)});let e=new FormData;typeof s.photo=="object"?n={...s}:n={...s,photo:"",cloneUrl:s.photo};for(const t in n)e.append(t,n[t]||"");e.append("contact_type_id","1"),e.append("currency_id",_),e.append("tax_exempt",JSON.stringify(!!s.tax_exempt)),e.append("same_as_billing",JSON.stringify(s.same_as_billing)),o.length>0&&e.append("is_attachment_deleted",JSON.stringify(o.length>0));for(let[t,a]of Object.entries(m))e.append(`attachments[${t}]`,a);for(let[t,a]of Object.entries(o))e.append(`deleted_attachments[${t}]`,a);for(let[t,a]of Object.entries(l))e.append(`clone_attachments[${t}]`,a);S(),b({method:"post",url:d,data:e}).then(t=>{t&&(P({message:t.message}),h(-1))})};return r.jsx(r.Fragment,{children:A?r.jsx(F,{supplier:!0,loading:j,onSubmit:O,attachList:c,setCurrency:f,setAttachList:p,deleteAttachments:o,url:`${d}/${g}/clone`,setDeleteAttachments:y,handleImageAttachList:C}):r.jsx(J,{})})};export{v as default};
