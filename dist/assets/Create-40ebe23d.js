import{F as d,i as f,j as e,aj as w,E as r,D as E,A as u,C as _,H as B,s as R,S as $,B as b,T as I,I as D,o as L,u as S,ai as O,h as N,l as T,aw as z}from"./index-4b3d7bc8.js";import{k as V}from"./calculation-671db1b1.js";import{E as X}from"./ExpenseForm-c21cee50.js";import{u as U}from"./usePermissions-36032956.js";import{A as H}from"./AccessDenied-45b92511.js";import"./index-76e73ee7.js";import"./index-b8658cbe.js";import"./progress-e3fed29d.js";const{Text:F}=I,{EXPENSE:M}=L,{RiDeleteBinLine:G,VscAdd:K}=D,q={bulk_expenses:[{date:"",tax_id:null,tag_id:null,description:"",total_amount:"",category_id:null,claim_reimbursement:!1}]},W=({loading:x,onSubmit:c,createFormData:p})=>{const[a]=d.useForm(),h=f(),n=d.useWatch("bulk_expenses",a),{expense_categories:g,paid_through_accounts:o,currencies:j,vendors:t,customers:i,taxes:m}=p,k=()=>{h(M)};return e.jsx(e.Fragment,{children:e.jsxs(d,{form:a,layout:"vertical",autoComplete:"off",name:"expense-form",onFinish:c,initialValues:q,children:[e.jsxs("table",{style:{width:"100%",borderSpacing:0,border:"1px solid #ddd",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"#d9d9d929"},children:[e.jsx("th",{style:{textAlign:"left",padding:"8px"},children:"EXPENSE DATE"}),e.jsx("th",{style:{textAlign:"left",padding:"8px"},children:"VENDOR"}),e.jsx("th",{style:{textAlign:"left",padding:"8px"},children:"CUSTOMER"}),e.jsx("th",{style:{textAlign:"left",padding:"8px"},children:"CATEGORY"}),e.jsx("th",{style:{textAlign:"left",padding:"8px"},children:"TAX"}),e.jsx("th",{style:{textAlign:"left",padding:"8px"},children:"AMOUNT"}),e.jsx("th",{style:{textAlign:"left",padding:"8px"},children:"REIMURSABLE"}),e.jsx("th",{style:{textAlign:"left",padding:"8px"},children:"BILLABLE"}),e.jsx("th",{style:{textAlign:"left",padding:"8px"},children:"PAID THORUGH"}),e.jsx("th",{style:{textAlign:"left",padding:"8px"},children:"DESCRIPTION"}),e.jsx("th",{style:{textAlign:"left",padding:"8px"},children:"REFERENCE#"})]})}),e.jsx(d.List,{name:"bulk_expenses",children:(C,{add:v,remove:P})=>e.jsxs(e.Fragment,{children:[C.map(({key:y,name:s,...l})=>{var A;return e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{style:{textAlign:"left",padding:"8px",width:"10%"},children:e.jsx(w,{...l,name:[`${s}`,"date"],isRequired:!0})}),e.jsx("td",{style:{textAlign:"left",padding:"8px",width:"10%"},children:e.jsx("div",{style:{display:"flex"},children:e.jsx(r,{...l,options:t,className:"flex_root",placeholder:"Select Vendor",name:[`${s}`,"vendor_id"]})})}),e.jsx("td",{style:{textAlign:"left",padding:"8px",width:"10%"},children:e.jsx("div",{style:{display:"flex"},children:e.jsx(r,{...l,options:i,className:"flex_root",placeholder:"Select Vendor",name:[`${s}`,"vendor_id"]})})}),e.jsx("td",{style:{textAlign:"left",padding:"8px",width:"10%"},children:e.jsx("div",{style:{display:"flex"},children:e.jsx(r,{...l,className:"flex_root",options:g,placeholder:"Select Category",name:[`${s}`,"category_id"],rules:E({message:"SelectCategory"})})})}),e.jsx("td",{style:{textAlign:"left",padding:"8px",width:"10%"},children:e.jsx("div",{style:{display:"flex"},children:e.jsx(r,{...l,options:m,className:"flex_root",placeholder:"Select Tax",name:[`${s}`,"tax_id"]})})}),e.jsx("td",{style:{textAlign:"left",padding:"8px",width:"15%"},children:e.jsx(u,{...l,name:[`${s}`,"total_amount"],rules:E({message:"Select Amount"}),addonBefore:e.jsx(r,{...l,name:[`${s}`,"currency_id"],options:j,size:"small"})})}),e.jsx("td",{style:{textAlign:"left",padding:"8px",width:"5%"},children:e.jsx(d.Item,{...l,valuePropName:"checked",name:[`${s}`,"claim_reimbursement"],children:e.jsx(_,{})})}),e.jsx("td",{style:{textAlign:"left",padding:"8px",width:"5%"},children:e.jsx(d.Item,{...l,valuePropName:"checked",name:[`${s}`,"billable"],children:e.jsx(_,{})})}),e.jsx("td",{style:{textAlign:"left",padding:"8px",width:"10%"},children:e.jsx(r,{...l,placeholder:"Select",className:"flex_root",options:o,name:[`${s}`,"paid_through_id"],disabled:n&&n.length&&((A=n[y])==null?void 0:A.claim_reimbursement)})}),e.jsx("td",{style:{textAlign:"left",padding:"8px",width:"10%"},children:e.jsx(u,{...l,name:[`${s}`,"description"],size:"large"})}),e.jsx("td",{style:{textAlign:"left",padding:"8px",width:"10%"},children:e.jsx(u,{...l,name:[`${s}`,"ref_number"],size:"middle"})}),e.jsx("td",{children:e.jsx(B,{title:"Delete",children:e.jsx(R,{shape:"circle",onClick:()=>P(s),style:{marginBottom:"23px"},icon:e.jsx(G,{size:14,color:"red"})})})})]},y)})}),e.jsx(d.Item,{children:e.jsxs(F,{onClick:()=>v(),style:{color:"blue",cursor:"pointer",marginLeft:"20px"},children:[e.jsx(K,{color:"blue"})," Add Another Line"]})})]})})]}),e.jsxs($,{style:{paddingLeft:"30px"},children:[e.jsx(b,{btnText:"Save",loading:x}),e.jsx(b,{type:"default",btnText:"Cancel",htmlType:"button",clickHandler:k})]})]})})},{BULK_EXPENSES:Y}=T,J=()=>{const x=f(),{callAxios:c,toggle:p,bool:a}=S(),{details:h}=O("expenses/create"),n=g=>{p(),c({method:"post",url:Y,data:g}).then(o=>{o&&(N({message:o.message}),x(-1))})};return e.jsx(W,{loading:a,onSubmit:n,createFormData:h})},{EXPENSES:Q,CREATE_EXPENSES:Z}=T,oe=()=>{const x=f(),{checkPermission:c}=U(),{callAxios:p,toggle:a,bool:h}=S(),{has_PurchaseOrderCreate_permission:n}=c("PurchaseOrderCreate"),g=t=>{let i;return t.itemize?i={...t,total_amount:(t==null?void 0:t.itemize)&&V(t==null?void 0:t.expense_details)}:i={...t},i},o=t=>{const i=g(t);a(),p({method:"post",url:Q,data:i}).then(m=>{m&&(N({message:m.message}),x(-1))})},j=[{key:"1",label:"Expense",children:e.jsx(X,{loading:h,onSubmit:o,url:Z})},{key:"2",label:"Bulk Expense",children:e.jsx(J,{})}];return e.jsx(e.Fragment,{children:n?e.jsx(e.Fragment,{children:e.jsx(z,{defaultActiveKey:"1",items:j})}):e.jsx(H,{})})};export{oe as default};
