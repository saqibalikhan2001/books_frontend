import{i as B,u as $,r as i,j as e,P as ke,n as Ce,o as W,p as pe,h as L,F as ye,q as ve,s as Fe,t as ge,v as Se,w as Te,x as Pe,y as Ne,B as Ie,l as Ae,z as ze}from"./index-4b3d7bc8.js";import{A as Oe,D as Ee}from"./DetailPage-51a1d58a.js";import{C as Re,i as Me,D as we,S as He,T as De,F as Le,R as ne,d as Be,h as $e,a as We,b as Ue,E as Ge}from"./DetailPlusListingHeader-5d7935e9.js";import{C as Ve,u as Qe}from"./useCustomPagination-4b61827d.js";import{T as qe,F as Xe,R as Je}from"./ResizealeTable-fbbbae57.js";import{u as Ke}from"./usePermissions-36032956.js";import{u as Ye}from"./useDetailPageProps-fa80b790.js";import{A as Ze}from"./AccessDenied-45b92511.js";import{A as es}from"./index-9f4b88aa.js";import"./capitalize-cfd5966b.js";import"./ImageCrop-db92a92e.js";import"./Processing-a1197381.js";import"./ActionMenu-149e95aa.js";import"./react-beautiful-dnd.esm-fdc0d50f.js";const{NEW_PRODUCT:ss}=Ce,{ADD_ITEM:ts}=W,{product_and_services:ls}=pe,ie=({enable:h=!1,noData:_=!1})=>{const r=B(),{callAxios:t}=$(),[a,c]=i.useState(!1),x=()=>{t({method:"post",url:"/items/export",data:{filter:"all"}}).then(j=>{let v="data:text/csv;charset=utf-8,"+j,k=encodeURI(v),n=document.createElement("a");n.setAttribute("href",k),n.setAttribute("download","products.csv"),document.body.appendChild(n),n.click(),L({message:"products exported successfully"})})},l=()=>c(!a),y=[{key:"1",label:"Categories",onClick:()=>r("/categories")},{key:"2",label:"Item Adjustment",onClick:l},{key:"3",label:"Export Items",onClick:x}],m=[{key:"1",label:"Inventory",onClick:()=>r("/items-new")},{key:"2",label:"Non-Inventory",disabled:!0},{key:"3",label:"Service",disabled:!0},{key:"4",label:"Bundle",disabled:!0},{key:"5",label:"Import Products",disabled:!0}];return e.jsxs(e.Fragment,{children:[e.jsx(ke.SubHeader,{item:!0,show:_,items:y,enabled:h,btnText:ss,navigateTo:ts,title:ls,itemdetails:!0,productItems:m}),e.jsx(Oe,{handleCancel:l,open:a})]})},os=({Prev:h,Next:_,refetch:r,listing:t,setparam:a,showDetail:c,handlePage:x,pagination:l,handleClick:y,handleRowSize:m,base_currency:j,handleConfirm:v,handleViewClick:k,sidebarPosition:n,handleFullScreen:I})=>{var Q,q,X,J,K,Y,Z,ee,se,te,le,oe,ae;const[F]=ye.useForm(),E=B(),{callAxios:b}=$(),[g,R]=i.useState(!1),[S,o]=i.useState(!1),[C,A]=i.useState(!1),[u,z]=i.useState([]),[T,M]=i.useState([]),[P,d]=i.useState([]),[O,de]=i.useState(),[me,ue]=i.useState(),{data:w=[]}=ve("",{refetchOnMountOrArgChange:!0}),U=()=>{setTimeout(()=>{R(!g)},2e3)},be=()=>{a({...l,page:1,filter:"",category_id:"",type:"",status:""})},G=s=>{F.setFieldsValue({type:l.type||"all",status:l.status||"all",filter:l.filter||"all",category_id:l.category_id||"all"}),o(s)},H=s=>M(s),he=s=>A(s),V=s=>d(s),fe=s=>E(`${W.ITEM_CLONE}?id=${s==null?void 0:s.id}`),_e=s=>{b({method:"put",url:s!=null&&s.is_active?`/items/${s==null?void 0:s.id}/inactive`:`/items/${s==null?void 0:s.id}/active`}).then(N=>{L({message:N==null?void 0:N.message}),r()})},xe=(s,N)=>{let D={};const re=u.map(f=>{var ce;return(ce=f==null?void 0:f.original)==null?void 0:ce.id});s==="category_assign"?D={category_id:N,ids:re}:D={ids:re},b({method:s==="delete"?"delete":"put",url:s==="delete"?"/items":`/items/${s}`,data:D}).then(f=>{L({message:f==null?void 0:f.message}),r(),s==="delete"&&ge(I)})},p=Re(c,Ue,t,fe,_e,y,v,j),je=Me(xe,w);return e.jsxs("div",{className:"item_listing",children:[c&&e.jsx(we,{form:F,Prev:h,Next:_,refetch:r,popOver:S,listing:t,setparam:a,moduleName:"Products",handlePage:x,pagination:l,categories:w,sortPopOver:C,navigateTo:"/items-new",handleRowSize:m,selectedProducts:u,handleSortPopOver:he,handleFullScreen:I,handleOpenChange:G}),u.length>0&&e.jsx(He,{showDetail:c,selectedProducts:u,items:je}),!u.length&&!c&&e.jsxs("div",{className:"custom-filter",children:[e.jsx(De,{listing:t,setparam:a,pagination:l}),e.jsxs("div",{className:"filter-bottom",children:[e.jsxs("div",{className:"d-flex",children:[e.jsx(Le,{form:F,popOver:S,setparam:a,pagination:l,categories:w,handleOpenChange:G}),((l==null?void 0:l.filter)||(l==null?void 0:l.status)||(l==null?void 0:l.category_id)||(l==null?void 0:l.type))&&e.jsx(Fe,{type:"link",className:"d-flex align-items-end clear_filter_btn",onClick:be,children:"Clear filters"})]}),e.jsxs("div",{className:"d-flex align-center",children:[e.jsx(qe,{url:"item",table_slug:"item",refetch:r,ColumnhideRef:O,ColumnOrderRef:me,handleSetCheck:U,setcolsheader:H,tableSetting:t.table_setting,colsHeader:T,preferences:(Q=t.table_setting)==null?void 0:Q.preferences,columns:p.filter(s=>s.locked===!1),column_reset_button:(q=t==null?void 0:t.table_setting)==null?void 0:q.column_reset_button,freeze_table_width:(X=t.table_setting)==null?void 0:X.freez_table_width})," ",e.jsx(Ve,{Prev:h,Next:_,paginate:l,handlePage:x,className:"pagination_row",handleRowSize:m,totalPages:t.items.last_page})]})]})]}),e.jsx("div",{style:{animation:c?"fadeInLeft":"",animationDuration:"0.5s"},className:"my-custom-table",children:e.jsxs("div",{id:"wrapper",className:"item_table",children:[e.jsx("div",{className:"sticky_table",children:e.jsx(Xe,{table_slug:"item",loading:!1,refetch:r,setparam:a,showDetail:c,pagination:l,ReturnWidth:ne,data:t.items.data,total:(J=t==null?void 0:t.items)==null?void 0:J.total,handleViewClick:k,setcolsheader:H,selectedProducts:u,tableSetting:t.table_setting,colsHeader:T,setSelectedProducts:z,preferences:(K=t.table_setting)==null?void 0:K.preferences,colsHeaderForlockedCols:P,detailPageColumns:["selection","name","action"],columns:p.filter(s=>s.locked===!0),handleTableFilterslockedcols:V,defaultFreezTableWidth:Be((Y=t.table_setting)==null?void 0:Y.freez_table_width),actionPref:$e((Z=t.table_setting)==null?void 0:Z.action_preference,(ee=p.filter(s=>s.locked===!0))==null?void 0:ee.length),sidebarPosition:n})}),!c&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"no_sticky_table",children:e.jsx(Je,{url:"item",check:g,table_slug:"item",refetch:r,loading:!1,setparam:a,pagination:l,ReturnWidth:ne,data:t.items.data,handleSetCheck:U,handleViewClick:k,setcolsheader:H,selectedProducts:u,tableSetting:t.table_setting,colsHeader:T,setSelectedProducts:z,preferences:(se=t.table_setting)==null?void 0:se.preferences,colsHeaderForlockedCols:P,columns:p==null?void 0:p.filter(s=>s.locked===!1),handleTableFilterslockedcols:V,defaultUnFreezTableWidth:We((te=t.table_setting)==null?void 0:te.freez_table_width),column_reset_button:(le=t==null?void 0:t.table_setting)==null?void 0:le.column_reset_button,setColumnOrderRef:ue,setColumnHideRef:de,freeze_table_width:(oe=t.table_setting)==null?void 0:oe.freez_table_width,sidebarPosition:n})})})]})}),e.jsx("div",{className:"item_listing_count",children:e.jsxs("p",{children:["Total Products : ",(ae=t==null?void 0:t.items)==null?void 0:ae.total]})})]})},{ITEMS:as}=Ae,{EDIT_ITEM:rs}=W,ps=()=>{var P;const h=B(),{bool:_,handleConfirm:r}=$(),{checkPermission:t}=Ke(),{paginate:a,Prev:c,Next:x,handlePage:l,handleRowSize:y,handlePagination:m}=Qe("items"),{has_ItemView_permission:j}=t("ItemView"),{getCurrentModule:v,checkModulePermission:k}=Se(),{status:n=void 0}=v("item")||{},{memoizeHandleClick:I,detail:F,setbool:E,fullScreen:b,bool:g,handleFullScreen:R}=Ye(),S=Te(d=>d.sidebarReducer),{data:o,refetch:C,isFetching:A}=Pe({paginate:a,sidebarPosition:S},{refetchOnMountOrArgChange:!0,skip:!j||k("item")}),u=d=>{ze(d==null?void 0:d.id,!0,"/items"),h(`${rs}?id=${d.id}`)},z=i.useCallback(u,[h]),T=i.useCallback(d=>{var O;return r(d,as,C,(O=o==null?void 0:o.items)==null?void 0:O.data,"/items",a,m)},[r,C,(P=o==null?void 0:o.items)==null?void 0:P.data,a,m]),M=()=>{m({...a,page:1,filter:"",category_id:"",status:"",type:""})};return e.jsx(e.Fragment,{children:j?e.jsx(e.Fragment,{children:_||A?e.jsx(Ne,{}):(o==null?void 0:o.items.data.length)>0?e.jsx("div",{className:"product_detail_listing",style:{animation:"slideInLeft",animationDuration:"0.5s"},children:e.jsxs(e.Fragment,{children:[!n&&e.jsx(es,{showIcon:!0,type:"info",message:"Module Permissions",description:"Please Enable Module Permissions To See Details"}),!b&&e.jsx(ie,{enable:!n}),e.jsxs("div",{className:b?"scrollbar_container":"",children:[!g&&e.jsx("div",{className:b?"list":"full_screen",children:(o==null?void 0:o.items)&&e.jsx(os,{Prev:c,Next:x,listing:o,refetch:C,loading:A,pagination:a,showDetail:b,handlePage:l,handleClick:z,setparam:m,handleRowSize:y,handleConfirm:T,base_currency:o.base_currency,handleFullScreen:R,handleViewClick:I,className:"generic-table item-table",sidebarPosition:S})}),b&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"content_side",children:(o==null?void 0:o.items)&&e.jsx(Ee,{detail:F,loading:g,setFalse:E,base_currency:o.base_currency,refetch:C})})})]})]})}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{enable:!n,noData:!0}),e.jsxs("div",{style:{display:"flex",height:"600px",alignItems:"center",flexDirection:"column",justifyContent:"center"},children:[e.jsx(Ge,{}),e.jsx("span",{children:"No data found"}),e.jsx(Ie,{type:"link",btnText:"Go Back",clickHandler:M})]})]})}):e.jsx(Ze,{})})};export{ps as default};
