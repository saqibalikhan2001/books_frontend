import{i as V,u as G,r as i,v as J,w as Q,Q as K,O as q,h as W,z as h,t as X,j as e,y as Y,B as Z,l as ee,o as se}from"./index-4b3d7bc8.js";import{D as ne}from"./DetailPage-c0159ae7.js";import{S as A,C as te}from"./Listing-ebb0bf80.js";import{u as ie}from"./useCustomPagination-4b61827d.js";import{u as oe}from"./usePermissions-36032956.js";import{u as le}from"./useDetailPageProps-fa80b790.js";import{A as ae}from"./AccessDenied-45b92511.js";import{A as re}from"./index-9f4b88aa.js";import{E as ce}from"./DetailPlusListingHeader-5d7935e9.js";import"./capitalize-cfd5966b.js";import"./Table-9972bb2a.js";import"./Processing-a1197381.js";import"./ActionMenu-149e95aa.js";import"./react-beautiful-dnd.esm-fdc0d50f.js";const{CUSTOMERS:ue}=ee,{EDIT_SUPPLIER:me}=se,ve=()=>{var _,v;const x=V(),{bool:D,callAxios:I,toggle:O}=G(),[j,u]=i.useState(!1),{checkPermission:F}=oe(),[t,c]=i.useState([]),{has_ContactView_permission:b}=F("ContactView"),{paginate:o,handlePagination:m,Next:M}=ie("contacts"),{getCurrentModule:z,checkModulePermission:B}=J(),{status:d=void 0}=z("contact")||{},{detail:T,setbool:L,fullScreen:r,bool:C,handleFullScreen:p,memoizeHandleClick:R}=le(),S=Q(n=>n.sidebarReducer),{data:s,refetch:g,isFetching:k}=K({paginate:o,sidebarPosition:S},{refetchOnMountOrArgChange:!0,skip:!b||B("contact")});i.useEffect(()=>(window.addEventListener("beforeunload",P),()=>{window.removeEventListener("beforeunload",P)}),[]);const P=()=>{const n={...o,page:1};localStorage.setItem("params",JSON.stringify(n))};i.useEffect(()=>{m({...o,page:1})},[]),i.useEffect(()=>{var n;o.page===1?(c(s==null?void 0:s.contacts.data),u(!1)):(c([...t,...(n=s==null?void 0:s.contacts)==null?void 0:n.data]),u(!1))},[s==null?void 0:s.contacts.data]);const $=n=>{h(n==null?void 0:n.id,!0,"/suppliers"),x(`${me}?id=${n.id}`)},H=i.useCallback($,[x]),E=i.useCallback(n=>{const l=JSON.parse(q("obj")),f=t.findIndex(a=>(a==null?void 0:a.id)===(n==null?void 0:n.id));O(),I({method:"delete",url:`${ue}/${n.id}`}).then(a=>{var y,w,N;a&&(W({message:a.message}),g(),t.length>1?h((y=t[f+1])!=null&&y.id?(w=t[f+1])==null?void 0:w.id:(N=t[f-1])==null?void 0:N.id,l!=null&&l.once?l==null?void 0:l.once:!1,"/suppliers",null,null):(h("",!1,"/suppliers",null,null),X(p),c([])))})},[t,g]),U=()=>{m({...o,page:1,sort:"asc",sort_column:"display_name",filter:"",searchByAlphabet:"",current_balance:"",start_range:"",end_range:""})};return e.jsx(e.Fragment,{children:b?e.jsx(e.Fragment,{children:D||!j&&k?e.jsx(Y,{}):((t==null?void 0:t.length)||((v=(_=s==null?void 0:s.contacts)==null?void 0:_.data)==null?void 0:v.length))>0?e.jsx("div",{className:"customer_detail_listing",children:e.jsxs(e.Fragment,{children:[!d&&e.jsx(re,{showIcon:!0,type:"info",message:"Module Permissions",description:"Please Enable Module Permissions To See Details"}),!r&&e.jsx(A,{enable:!d,supplier:!0}),e.jsxs("div",{className:r?"scrollbar_container":"",children:[!C&&e.jsx("div",{className:r?"list":"full_screen",children:(s==null?void 0:s.contacts)&&e.jsx(te,{supplier:!0,next:M,listing:s,loader:j,refetch:g,products:t,loading:k,pagination:o,setLoader:u,showDetail:r,setProducts:c,handleClick:H,setparam:m,handleConfirm:E,sidebarPosition:S,handleFullScreen:p,handleViewClick:R})}),r&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"content_side",children:(s==null?void 0:s.contacts)&&e.jsx(ne,{supplier:!0,detail:T,loading:C,setFalse:L,handleConfirm:E,handleFullScreen:p})})})]})]})}):e.jsxs(e.Fragment,{children:[e.jsx(A,{supplier:!0,enable:!d}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"600px",flexDirection:"column"},children:[e.jsx(ce,{}),e.jsx("span",{children:"No data found"}),e.jsx(Z,{type:"link",btnText:"Go Back",clickHandler:U})]})]})}):e.jsx(ae,{})})};export{ve as default};
