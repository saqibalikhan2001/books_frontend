import{j as e,P as ts,o as _e,F as V,r as d,E as Ce,R as je,B as he,A as Me,U as as,V as ls,W as rs,T as E,H as K,u as fe,X as ns,Y as Ye,I as ke,Z as cs,y as ye,i as Xe,_ as be,C as os,s as me,M as ds,S as Le,$ as is,n as We,a0 as ms,a1 as hs,a2 as us,a3 as xs,h as Ve,t as ps}from"./index-4b3d7bc8.js";import{s as bs,c as _s,e as xe,L as ge,r as M,f as fs,g as De,j as qe,k as Ke,l as Qe,m as js,G as gs,n as Cs,o as Ue,d as ys,h as ks,a as Ns}from"./DetailPlusListingHeader-5d7935e9.js";import{u as Ss}from"./usePermissions-36032956.js";import{A as ws}from"./ActionMenu-149e95aa.js";import{D as Rs,C as zs,P as Ps}from"./react-beautiful-dnd.esm-fdc0d50f.js";const{ADD_CUSTOMER:vs,ADD_SUPPLIER:Ts}=_e,Fs=[{key:"1",label:"Import customers",disabled:!0}],Hs=[{key:"1",label:"Import suppliers",disabled:!0}],qs=({enable:r=!1,supplier:c=!1})=>e.jsx(e.Fragment,{children:e.jsx(ts.SubHeader,{customer:!0,enabled:r,items:c?Hs:Fs,title:c?"Suppliers":"Customers",btnText:c?"New supplier":"New customer",navigateTo:c?Ts:vs})}),Os=({setparam:r,pagination:c,handleSortPopOver:i})=>{const[p]=V.useForm(),[a,R]=d.useState("asc"),m=V.useWatch("sort",p),h=V.useWatch("sort_column",p),g=u=>R(u.target.value);return e.jsx("div",{className:"_generic_popupover_main",children:e.jsxs(V,{form:p,className:"inner_spacing",initialValues:{sort:c.sort||"asc",sort_column:c.sort_column||null},onFinish:u=>{r({...c,sort:u.sort,sort_column:u==null?void 0:u.sort_column}),i(!1)},style:{maxWidth:600},children:[e.jsx("div",{className:"form_group  mb-30",children:e.jsx(Ce,{label:"",size:"middle",name:"sort_column",className:"adjustment-field",placeholder:"Sort by column",options:[{id:"display_name",label:"Display name"}]})}),e.jsxs("div",{className:"form_group  mb-30",children:[e.jsx("label",{children:"Sort order"}),e.jsx(V.Item,{name:"sort",children:e.jsxs(je.Group,{value:a,onChange:g,className:"important-block",children:[e.jsx(je,{value:"asc",className:"block",children:"Ascending"}),e.jsx(je,{value:"desc",className:"block",children:"Descending"})]})})]}),e.jsx("div",{className:"d-flex justify-center",children:e.jsx(he,{className:"btn-primary w-96px h-36px",btnText:"Apply",disabled:c.sort===m&&c.sort_column===h})})]})})},Ge=({form:r,pagination:c,setparam:i,setPopOver:p})=>{const a=V.useWatch("filter",r),R=V.useWatch("end_range",r),m=V.useWatch("start_range",r),h=V.useWatch("current_balance",r);return e.jsx("div",{className:"_generic_popupover_main",children:e.jsxs(V,{form:r,initialValues:{filter:c.filter||"all",current_balance:c.current_balance||"all",start_range:c.start_range||"",end_range:c.end_range||""},onFinish:g=>{i({...c,page:1,filter:g.filter,current_balance:g.current_balance,start_range:g.start_range||"",end_range:g.end_range||""}),p(!1)},style:{maxWidth:600,minWidth:250},children:[e.jsxs("div",{className:"form_group  mb-30",children:[e.jsx("label",{children:"Status"}),e.jsx(Ce,{label:"",size:"middle",name:"filter",options:bs,allowClear:!1,placeholder:"Adjustment Type",className:"adjustment-field"})]}),e.jsxs("div",{className:"form_group  mb-30",children:[e.jsx("label",{children:"Current balance"}),e.jsx(Ce,{label:"",size:"middle",allowClear:!1,name:"current_balance",options:_s,className:"adjustment-field",placeholder:"Select current balance"})]}),h&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"form_group  mb-30",children:h!=="all"&&e.jsx(Me,{name:"start_range",type:"number",stringMode:!1})}),e.jsx("div",{className:"form_group  mb-30",children:h==="in_between"&&e.jsx(Me,{name:"end_range",type:"number",stringMode:!1})})]}),e.jsxs("div",{className:"d-flex _generic_popupover_actions ",children:[e.jsx(he,{type:"text",btnText:"Reset",disabled:a==="all"&&h==="all",clickHandler:()=>{r.setFieldsValue({filter:"all",current_balance:"all",start_range:null,end_range:null})},className:"btn-default mr-15 w-96px h-36px"}),e.jsx(he,{className:"btn-primary w-96px h-36px",btnText:"Apply",disabled:c.filter===a&&c.end_range===R&&c.start_range===m&&c.current_balance===h})]})]})})},{Text:pe}=E,As=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","#"],Ze=({indeterminate:r,className:c="",...i})=>{const p=d.useRef(null);return d.useEffect(()=>{typeof r=="boolean"&&(p.current.indeterminate=!i.checked&&r)},[p,r]),e.jsx("input",{type:"checkbox",ref:p,className:c+" cursor-pointer chcekbox-size",...i})},Es=(r,c,i,p,a,R,m,h,g)=>{var U,T,z,F,H,C,O;const{created_by_platform:u}=as(),{checkPermission:l}=Ss(),{has_ContactDelete_permission:D}=l("ContactDelete");return[{id:"selection",Header:s=>e.jsx(e.Fragment,{children:e.jsx(Ze,{checked:s.isAllRowsSelected,indeterminate:s==null?void 0:s.isAllPageRowsSelected,onChange:()=>s.toggleAllRowsSelected()})}),Cell:({cell:s})=>{var N,w;return e.jsx(e.Fragment,{children:e.jsx(Ze,{checked:(N=s==null?void 0:s.row)==null?void 0:N.isSelected,disabled:!1,indeterminate:(w=s==null?void 0:s.row)==null?void 0:w.isSomeSelected,onChange:()=>{var S;return(S=s==null?void 0:s.row)==null?void 0:S.toggleRowSelected()}})})},width:50,minWidth:50,resizable:!1,isResizing:!1,disableResizing:!0,getResizerProps:()=>{},defaultResizeableColumn:!1,locked:!0,icon:!1},{Header:"Name",id:"display_name",accessor:s=>s,Cell:({value:s})=>{var N;return e.jsxs("div",{className:"product_info big_chill customer_line_clamp",children:[e.jsx(ls,{preview:!1,src:s!=null&&s.photo?rs(s==null?void 0:s.photo,u):"https://s3-us-west-2.amazonaws.com/ims-development/media/default-user-image-placeholder.svg"}),e.jsxs("div",{className:"product-title",children:[e.jsx(pe,{children:s==null?void 0:s.display_name}),!r&&e.jsx(pe,{children:s==null?void 0:s.company_name}),r&&e.jsx("div",{className:"stock_info",children:e.jsx(pe,{children:`${(N=i==null?void 0:i.base_currency)==null?void 0:N.symbol}${m?s==null?void 0:s.payable.toFixed(2):s==null?void 0:s.receivable.toFixed(2)} `})})]})]})},minWidth:200,width:r?322:h("display_name"),locked:g("display_name"),default:xe("display_name",(U=i.table_setting)==null?void 0:U.preferences)},{Header:"",id:"action",resizable:!1,isResizing:!1,disableResizing:!0,getResizerProps:()=>{},defaultResizeableColumn:!1,disableSortBy:!0,accessor:s=>s,disabledSort:!0,width:r?45:h("action"),minWidth:r?45:30,locked:!0,icon:!1,Cell:({value:s})=>e.jsx(ws,{contact:!0,data:s,handleClone:p,handleStatus:c,handleClick:a,handleConfirm:R,active:!!(s!=null&&s.is_active),status:s.platform_type==="books",canEdit:s.platform_type==="books",hasTransaction:s==null?void 0:s.has_transaction,deletePermission:s.platform_type==="books"?D:!1,title:s!=null&&s.has_transaction?`You cannot delete ${m?"supplier":"customer"} having transactions`:s.platform_type==="books"&&D?`Are you sure you want to delete "${s.display_name}"?`:"Permission Denied"})},{Header:"Phone",accessor:"work_phone",width:r?0:h("work_phone"),locked:g("work_phone"),default:xe("work_phone",(T=i.table_setting)==null?void 0:T.preferences),is_lockable:ge("work_phone",(z=i.table_setting)==null?void 0:z.preferences)},{Header:"Email",id:"email",accessor:s=>s,Cell:({value:s})=>e.jsx("span",{className:"text_truncate",children:s.email}),minWidth:r?0:150,width:r?0:h("email"),locked:g("email"),default:xe("email",(F=i.table_setting)==null?void 0:F.preferences),is_lockable:ge("email",(H=i.table_setting)==null?void 0:H.preferences)},{Header:"Current Balance",accessor:`${m?"payable":"receivable"}`,width:r?0:h(`${m?"payable":"receivable"}`)?h(`${m?"payable":"receivable"}`):10,locked:g(`${m?"payable":"receivable"}`),default:xe(`${m?"payable":"receivable"}`,(C=i.table_setting)==null?void 0:C.preferences),is_lockable:ge(`${m?"payable":"receivable"}`,(O=i.table_setting)==null?void 0:O.preferences),Cell:({cell:{value:s}})=>{var N,w;return e.jsxs(E,{children:[e.jsx(K,{placement:"topLeft",title:(N=i==null?void 0:i.base_currency)==null?void 0:N.name,children:e.jsx(pe,{code:!0,children:(w=i==null?void 0:i.base_currency)==null?void 0:w.symbol})}),`${s.toFixed(2)}`]})}}]},{CiUnlock:Is}=ke,Bs=r=>{const{callAxios:c,toggle:i}=fe(),{data:p,check:a,refetch:R,colsHeader:m,table_slug:h,pagination:g,preferences:u,tableSetting:l,sidebarPosition:D,handleViewClick:U,freezeTableWidth:T,setColumnHideRef:z,setColumnOrderRef:F,setparam:H=()=>null,colsHeaderForlockedCols:C,defaultUnFreezTableWidth:O,handleTableFilterslockedcols:s}=r,N=d.useMemo(()=>r.columns,[C]),{setcolsheader:w}=r,S=JSON.parse(localStorage.getItem("params")),[A,b]=d.useState(!1),[I,Z]=d.useState(),{getTableProps:B,getTableBodyProps:Q,state:J,headerGroups:_,rows:j,prepareRow:v,allColumns:P,setColumnOrder:G,setHiddenColumns:te}=M.useTable({columns:N,data:p||[],defaultColumn:O,manualSortBy:!0,initialState:{hiddenColumns:fs(u),columnOrder:De(u)}},M.useSortBy,M.useBlockLayout,M.useResizeColumns,M.useRowSelect,M.useColumnOrder),{columnResizing:{columnWidths:ae,isResizingColumn:Y}}=J;d.useEffect(()=>{F(()=>G),z(()=>te)},[]),d.useEffect(()=>{G(De(u))},[u]);const ee=P.map(x=>x.Header),le=m.map(x=>x.Header),se=!!ns.isEqual(ee,le);d.useEffect(()=>{se||w(P)},[a]);const re=d.useCallback(Ye(x=>{i(),c({method:"post",url:"/table-setting",data:x})},400),[]);d.useEffect(()=>{qe(ae,Y,u,re,h,l,D)},[ae]);const X=x=>{H({...g,page:1,sort:S.sort==="asc"?"desc":"asc",pageSize:30,sort_column:x})},ne=()=>{const{data:x}=I;let y={slug:h,freez_table_width_px:l==null?void 0:l.freez_table_width_px,preferences:x};c({method:"post",url:"/locked-columns",data:y}).then(()=>R())};return e.jsxs(d.Fragment,{children:[T!==100&&e.jsxs("table",{...B(),id:"resizeabletable",children:[e.jsx("thead",{children:_.map(x=>e.jsx("tr",{...x.getHeaderGroupProps(),children:x.headers.map(y=>e.jsxs("th",{...y.getHeaderProps(),className:`th ${y.isResizing?"--resizing":""}`,children:[e.jsxs("span",{...y.getSortByToggleProps(),onClick:L=>{L.stopPropagation(),X(y==null?void 0:y.id)},children:[y.render("Header"),e.jsx("span",{children:S&&(S!=null&&S.sort)&&S.sort_column===y.id?(S==null?void 0:S.sort)==="asc"?e.jsx("span",{className:"arrow arrow-bar is-top"}):e.jsx("span",{className:"arrow arrow-bar is-bottom"}):""})]}),e.jsx("div",{onClick:L=>L.stopPropagation(),...y.getResizerProps({style:{userSelect:"none"}}),className:`${y.resizable===void 0?"resizer isResizing":"no-resize"}`}),y.is_lockable&&e.jsxs("span",{style:{cursor:"pointer"},onClick:()=>Ke(y.id,u,m,w,c,R,s,C,G,h,i,b,Z),children:[e.jsx(Is,{size:18,style:{marginLeft:"10px"}})," "]})]}))}))}),e.jsx("tbody",{...Q(),children:j.map((x,y)=>(v(x),e.jsx("tr",{...x.getRowProps(),onMouseEnter:()=>r.onRowHover(y),onMouseLeave:()=>r.onRowHover(null),onClick:()=>U(x==null?void 0:x.original,r.data),style:{opacity:x!=null&&x.original.is_active?1:.5},children:x.cells.map(L=>L.column.locked===!1&&e.jsx("td",{...L.getCellProps(),valign:"middle",children:L.render("Cell")}))})))})]}),e.jsx(Qe,{content:I==null?void 0:I.message,isModalOpen:A,setIsModalOpen:b,handleSubmitSuitableWidth:ne})]})};let Je;const $s=r=>{const{callAxios:c,toggle:i}=fe(),{data:p,total:a,loader:R,refetch:m,setparam:h,colsHeader:g,table_slug:u,showDetail:l,pagination:D,actionPref:U,preferences:T,tableSetting:z,setcolsheader:F,handleViewClick:H,sidebarPosition:C,detailPageColumns:O,defaultFreezTableWidth:s,colsHeaderForlockedCols:N,handleTableFilterslockedcols:w}=r,S=d.useMemo(()=>r.columns,[T,N,l]),A=JSON.parse(localStorage.getItem("obj")),b=JSON.parse(localStorage.getItem("params")),[I,Z]=d.useState(!1),[B,Q]=d.useState(),{rows:J,state:_,allColumns:j,prepareRow:v,headerGroups:P,getTableProps:G,selectedFlatRows:te,getTableBodyProps:ae,setColumnOrder:Y}=M.useTable({columns:S,data:p||[],defaultColumn:s,manualSortBy:!0},M.useSortBy,M.useBlockLayout,M.useResizeColumns,M.useRowSelect,M.useColumnOrder),{columnResizing:{columnWidths:ee,isResizingColumn:le,headerIdWidths:se},selectedRowIds:re,columnOrder:X}=_;d.useEffect(()=>{let o=document.getElementsByClassName("active_row");o[0]&&o[0].scrollIntoView({block:"center",inline:"center"})},[A==null?void 0:A.curr_id]),d.useEffect(()=>{l&&Y(O)},[l,O]),d.useEffect(()=>{Je=X.indexOf("action")},[X]),d.useEffect(()=>{const{setSelectedProducts:o}=r;o(te)},[re]);const ne=(o,n,f)=>{const W=[...f],ce=W.splice(o,1)[0];return W.splice(n,0,ce),W};d.useEffect(()=>{w(j);const o=j.map(W=>W.id),n=o.indexOf("action"),f=ne(n,U,o);Y(f)},[T]);const x=d.useCallback(Ye(o=>{i(),c({method:"post",url:"/table-setting",data:o}).then(n=>{n.status===403&&(n.show_popup&&Z(!0),Q(n))})},400),[]),y=()=>{var ue,q;const o=document.getElementById("resizeabletable"),n=Object.keys(ee),f=Object.values(ee),W=n.indexOf((ue=se==null?void 0:se[0])==null?void 0:ue[0]);let ce={};if(n.length&&f.length&&W!==-1){let de;C!=null&&C.open,de=window.innerWidth-((C==null?void 0:C.width)+10),ce={slug:u,freez_table_width_px:(z==null?void 0:z.freez_table_width_px)||null,unfreez_table_width_px:(o==null?void 0:o.clientWidth)||null,screen_resolution:de,preferences:{name:n[W],width:parseFloat((q=B==null?void 0:B.data)==null?void 0:q.suitable_width_px).toFixed(0),slug:n[W]}},c({method:"post",url:"/table-setting",data:ce}).then(()=>{m()})}};d.useEffect(()=>{qe(ee,le,T,x,u,z,C)},[ee]);const L=o=>{h({...D,page:1,sort:b.sort==="asc"?"desc":"asc",pageSize:30,sort_column:o})};return e.jsxs(d.Fragment,{children:[e.jsxs("table",{...G(),className:l?"hide_shadow":"",children:[e.jsx("thead",{children:P.map(o=>e.jsxs("tr",{...o.getHeaderGroupProps(),children:[!l&&o.headers.map(n=>n.locked&&n.id!=="action"&&e.jsxs("th",{...n.getHeaderProps({style:{width:n.id===X[Je-1]?n.width+30:n.width}}),className:b&&(b!=null&&b.sort)&&b.sort_column===n.id&&(b.sort==="asc"||b.sort==="desc")?"bg-color":"",children:[e.jsxs("span",{...n.getSortByToggleProps(),onClick:f=>{f.stopPropagation(),n.id!=="selection"&&n.id!=="action"&&L(n==null?void 0:n.id)},children:[n.render("Header"),e.jsx("span",{children:b&&(b!=null&&b.sort)&&b.sort_column===n.id?(b==null?void 0:b.sort)==="asc"?e.jsx("span",{className:"arrow arrow-bar is-top"}):e.jsx("span",{className:"arrow arrow-bar is-bottom"}):""})]}),e.jsx("div",{onClick:f=>f.stopPropagation(),...n.getResizerProps({style:{userSelect:"none"}}),className:`${n.resizable===void 0?"resizer isResizing":"no-resize"}`}),n.id==="selection"||n.id==="action"?"":e.jsx("span",{style:{cursor:n.default?"not-allowed":"pointer"},onClick:()=>n.default?null:Ke(n.id,T,g,F,c,m,w,N,Y,u,i),children:e.jsx(cs,{size:20,className:"lock"})})]})),l&&o.headers.slice(0,3).map(n=>n.locked&&e.jsx("th",{...n.getHeaderProps(),children:e.jsxs("span",{children:[n.render("Header"),e.jsx("div",{onClick:f=>f.stopPropagation(),...n.getResizerProps({style:{userSelect:"none"}})})]})}))]}))}),e.jsx("tbody",{...ae(),children:J.map((o,n)=>(v(o),e.jsxs("tr",{...o.getRowProps(),onMouseEnter:()=>r.onRowHover(n),onMouseLeave:()=>r.onRowHover(null),style:{opacity:o!=null&&o.original.is_active?1:.5},className:(o==null?void 0:o.original.id)===(A==null?void 0:A.curr_id)&&l?"active_row":"",children:[!l&&o.cells.map(f=>f.column.locked===!0&&e.jsx("td",{onClick:()=>f.column.id!=="selection"&&H(o==null?void 0:o.original,p),...f.getCellProps(),className:f.column.id==="action"?"action-cell":"",children:f.render("Cell")})),l&&o.cells.slice(0,3).map(f=>f.column.locked===!0&&e.jsx("td",{onClick:()=>f.column.id!=="selection"&&H(o==null?void 0:o.original,p),...f.getCellProps(),children:f.render("Cell")}))]})))}),l&&e.jsxs(e.Fragment,{children:[R&&e.jsx(ye,{size:"small"}),e.jsx("tfoot",{className:"listing-count simple_visible",children:e.jsx("tr",{children:e.jsx("td",{className:"w-100",children:e.jsx("div",{className:"listing-count-inner",children:u==="supplier"?`Total Suppliers : ${a}`:`Total Contacts : ${a}`})})})})]})]}),e.jsx(Qe,{content:B==null?void 0:B.message,isModalOpen:I,setIsModalOpen:Z,handleSubmitSuitableWidth:y})]})},{MdDragIndicator:Ms}=ke,Ls=r=>{var J;const{url:c,refetch:i,columns:p,colsHeader:a,table_slug:R,preferences:m,ColumnhideRef:h,setcolsheader:g,ColumnOrderRef:u,handleSetCheck:l,freeze_table_width:D,column_reset_button:U}=r,T=Xe(),{callAxios:z,toggle:F,bool:H}=fe(),[C,O]=d.useState(!1),[s,N]=d.useState([]),[w,S]=d.useState([]),[A,b]=d.useState(!1);let I=r.preferences.map(_=>{if(_.show_status===!1)return _.slug});I=I.filter(_=>!!_),d.useEffect(()=>{const _=r.preferences.map(v=>{if(v.show_status===!1)return v.slug}),j=_==null?void 0:_.filter(v=>!!v);N(j)},[]);const Z=_=>{if(!_.destination)return;const j=Array.from(a),[v]=j.splice(_.source.index,1);j.splice(_.destination.index,0,v),g(j);const P=j.map(G=>G.id);S(P),u(P)},B=_=>{O(_)},Q=_=>{!_&&D===100&&(s==null?void 0:s.length)<I.length&&b(!0)};return e.jsxs(e.Fragment,{children:[!((J=r.selectedProducts)!=null&&J.length)&&e.jsx(be,{overlayClassName:"item_filter",placement:"bottomLeft",open:C,onVisibleChange:Q,onOpenChange:B,content:e.jsx("div",{className:"product-filters",children:e.jsx(Rs,{onDragEnd:Z,children:e.jsx(zs,{droppableId:"droppable",children:_=>e.jsxs("div",{ref:_.innerRef,children:[a.map((j,v)=>e.jsx(Ps,{draggableId:j.id,index:v,children:P=>e.jsx("div",{className:"col_name",ref:P.innerRef,...P.draggableProps,...P.dragHandleProps,children:e.jsxs("div",{className:"__dragDrop",children:[e.jsx("div",{...P.dragHandleProps,className:"__dragDrop_iconParent",tabIndex:"-1",children:e.jsx(Ms,{})}),e.jsx("div",{className:"__drag-righ",children:e.jsxs("label",{children:[e.jsx(os,{className:"custom_checkbox",...j.getToggleHiddenProps(),onChange:()=>{js(j.id,s,N,a,g,p,h)},style:{cursor:j.locked?"not-allowed":"pointer"}})," ",j.Header]})})]})})},gs())),e.jsxs(e.Fragment,{children:[_.placeholder,e.jsxs("div",{className:"button_flexbox ",children:[e.jsx(he,{type:"default",btnText:"Reset",disabled:U||H,htmlType:"button",className:"btn-default btn-form-size mr-20",clickHandler:()=>Cs(z,i,l,F,T,c)}),e.jsx(he,{btnText:"Apply",disabled:H,className:"btn-primary btn-form-size",clickHandler:()=>{Ue(w,s,z,u,i,m,R,F)}})]})]})]})})})}),trigger:"click",children:e.jsx(K,{placement:"bottom",title:"Show Columns",children:e.jsx(me,{className:"btn-filter",children:e.jsx("img",{src:"https://ims-development.s3.us-west-2.amazonaws.com/static/media/show-columns.png",alt:""})})})}),e.jsxs(ds,{centered:!0,footer:null,destroyOnClose:!0,closable:!1,open:A,maskClosable:!1,width:400,className:"radius-5 default_modal",children:[e.jsx(Le,{children:e.jsx(E.Text,{children:"If you want to preview live changes, kindly press save button."})}),e.jsx(is,{justify:"center",children:e.jsxs(Le,{children:[e.jsx(me,{className:"btn-form-size btn-default",onClick:()=>b(!1),children:We.CANCEL}),e.jsx(me,{className:"btn-form-size btn-primary",onClick:()=>{Ue(w,s,z,u,i,m,R,F)},children:We.SAVE})]})})]})]})},{GoPlus:Ws}=ke,{Title:Vs}=E,{ADD_SUPPLIER:Ds,ADD_CUSTOMER:Us}=_e,Ks=({next:r,loader:c,loading:i,refetch:p,listing:a,products:R,supplier:m,setparam:h,setLoader:g,showDetail:u,pagination:l,handleClick:D,handleConfirm:U,handleViewClick:T,sidebarPosition:z,handleFullScreen:F,setProducts:H})=>{var Ne,Se,we,Re,ze,Pe,ve,Te,Fe,He,Oe,Ae,Ee,Ie,Be,$e;const C=d.useRef(),[O]=V.useForm(),s=Xe(),{callAxios:N}=fe(),[w,S]=d.useState(!1),[A,b]=d.useState(!1),[I,Z]=d.useState(),[B,Q]=d.useState(!1),[J,_]=d.useState(),[j,v]=d.useState([]),[P,G]=d.useState([]),[te,ae]=d.useState([]),[Y,ee]=d.useState(null),le=t=>{},se=`${m?"supplier":"customer"}`;let re=(Ne=a==null?void 0:a.contacts)!=null&&Ne.total?(Se=a==null?void 0:a.contacts)==null?void 0:Se.total:(we=a==null?void 0:a.contacts)==null?void 0:we.data.length;const X=()=>{setTimeout(()=>{S(!w)},2e3)},ne=t=>{ae(t)},x=t=>{G(t)},y=(t="")=>{var $,ie;const k=($=a.table_setting)==null?void 0:$.preferences.find(ss=>ss.slug===t);return Number(parseFloat(k==null?void 0:k.width_px))?Number(parseFloat(k==null?void 0:k.width_px)):((ie=a==null?void 0:a.table_setting)==null?void 0:ie.freez_table_width)===100?NaN:120},L=(t="")=>{var oe;const k=(oe=a.table_setting)==null?void 0:oe.preferences.find($=>$.slug===t);return k==null?void 0:k.locked},o=t=>{O.setFieldsValue({filter:l.filter||"all",end_range:l.end_range||null,start_range:l.start_range||null,current_balance:l.current_balance||"all"}),b(t)},n=()=>{h({...l,page:1,sort:"asc",sort_column:"display_name",filter:"",searchByAlphabet:"",current_balance:"",start_range:"",end_range:""})},f=t=>Q(t),W=t=>s(`${m?_e.SUPPLIER_CLONE:_e.CUSTOMER_CLONE}?id=${t==null?void 0:t.id}`),ce=t=>{N({method:"put",url:t!=null&&t.is_active?`/contacts/${t==null?void 0:t.id}/inactive`:`/contacts/${t==null?void 0:t.id}/active`}).then(k=>{Ve({message:k==null?void 0:k.message}),p()})},ue=t=>{let k={};k={ids:j.map($=>{var ie;return(ie=$==null?void 0:$.original)==null?void 0:ie.id})},N({method:t==="delete"?"delete":"put",url:t==="delete"?"/contacts":`/contacts/${t}`,data:k}).then($=>{Ve({message:$==null?void 0:$.message}),p(),t==="delete"&&ps(F)})},q=Es(u,ce,a,W,D,U,m,y,L),de=[{key:"1",label:"Send",disabled:!0},{key:"2",label:"Print",disabled:!0},{key:"3",label:e.jsx(xs,{placement:"left",title:"Are you sure you want to delete selected customers?",okText:"Yes",cancelText:"No",showCancel:!0,onCancel:t=>t==null?void 0:t.stopPropagation(),onConfirm:t=>{t==null||t.stopPropagation(),ue("delete")},children:e.jsx(K,{title:"Delete",children:e.jsx("label",{style:{display:"block",width:"100%"},onClick:t=>t==null?void 0:t.stopPropagation(),children:"Delete"})})},"confirm")}],es=()=>{if(C.current){const{scrollTop:t,scrollHeight:k,clientHeight:oe}=C.current;Math.ceil(t+oe+50)>=k-2&&a.contacts.last_page>a.contacts.current_page&&!c&&(g(!0),r())}};return e.jsxs("div",{className:"customer_listing_page",style:{animation:"slideInLeft",animationDuration:"0.5s"},children:[!u&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"custom-filter",children:[e.jsxs("div",{className:"filter-top",children:[e.jsxs("div",{className:"filter-badge blue_shade",children:[e.jsx(E.Text,{className:"key",children:"$100000"}),e.jsx(E.Text,{className:"value",children:m?"0 Purchase Order":"10 Estimate"})]}),e.jsxs("div",{className:"filter-badge orange_shade",children:[e.jsx(E.Text,{className:"key",children:"$100000"}),e.jsx(E.Text,{className:"value",children:"15 Overdue"})]}),e.jsxs("div",{className:"filter-badge purple_shade",children:[e.jsx(E.Text,{className:"key",children:"$100000"}),e.jsx(E.Text,{className:"value",children:m?"8 Open Bills":"8 Open Invoices"})]}),e.jsxs("div",{className:"filter-badge green_shade",children:[e.jsx(E.Text,{className:"key",children:"$100000"}),e.jsx(E.Text,{className:"value",children:"3 Paid last 30 days"})]})]}),!j.length&&e.jsxs("div",{className:"clear_filter ",children:[e.jsx(K,{placement:"bottom",title:"Filter",children:e.jsx(be,{title:"",open:A,trigger:"click",placement:"bottomLeft",content:e.jsx(Ge,{form:O,setparam:h,pagination:l,setPopOver:b}),className:"filter_listing",onOpenChange:o,overlayClassName:"adjust-filter-main",children:e.jsx("img",{src:"https://s3-us-west-2.amazonaws.com/ims-development/static/media/Filter.svg",alt:"",className:"popup-over another-filter"})})}),((l==null?void 0:l.filter)||(l==null?void 0:l.current_balance)||(l==null?void 0:l.start_range)||(l==null?void 0:l.end_range)||(l==null?void 0:l.searchByAlphabet))&&e.jsx(me,{type:"link",className:"clear_filter_btn",onClick:n,children:"Clear filters"}),e.jsx(Ls,{url:"item",refetch:p,ColumnhideRef:I,ColumnOrderRef:J,handleSetCheck:X,setcolsheader:x,colsHeader:P,table_slug:m?"supplier":"customer",preferences:(Re=a.table_setting)==null?void 0:Re.preferences,columns:q.filter(t=>t.locked===!1),freeze_table_width:(ze=a.table_setting)==null?void 0:ze.freez_table_width,column_reset_button:(Pe=a==null?void 0:a.table_setting)==null?void 0:Pe.column_reset_button})]})]})}),j.length>0?e.jsx(d.Fragment,{children:e.jsxs("div",{className:u?"product-detail-list product_list":"product_list",children:[e.jsxs(E.Title,{className:"selected_product",level:3,children:[j.length," ",m?"Suppliers Selected":"Customers Selected"]}),e.jsx(ms,{menu:{items:de},trigger:["click"],children:e.jsxs("span",{style:{cursor:"pointer"},children:["Batch Actions ",e.jsx(hs,{})]})})]})}):u?e.jsx("div",{className:"product_detail_pagination",children:e.jsxs("div",{className:"breadcrumb_row customer_detail_breadcrumb",children:[e.jsx(us,{name:"",detailPage:!0,refetch:p,handleFullScreen:F,moduleName:m?"Suppliers":"Customers"}),e.jsxs("div",{className:"add_btn_outer",children:[e.jsx(K,{placement:"bottom",title:m?"Add new supplier":"Add new customer",children:e.jsx(me,{icon:e.jsx(Ws,{}),onClick:()=>s(`${m?Ds:Us}`)})}),e.jsx(K,{placement:"bottom",title:"sort",children:e.jsx(be,{title:e.jsx(Vs,{className:"text-align",level:5,children:"Sorting"}),trigger:"click",open:B,placement:"bottomRight",onOpenChange:f,overlayClassName:"adjust-filter-main  ",content:e.jsx(Os,{setparam:h,pagination:l,handleSortPopOver:f}),children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"17.831",height:"15.138",viewBox:"0 0 17.831 15.138",children:[e.jsx("defs",{children:e.jsx("clipPath",{id:"clip-path",children:e.jsx("rect",{id:"Rectangle_2085","data-name":"Rectangle 2085",width:"17.831",height:"15.138",fill:"#6e6e6e"})})}),e.jsxs("g",{id:"Group_11160","data-name":"Group 11160",clipPath:"url(#clip-path)",children:[e.jsx("path",{id:"Path_10301","data-name":"Path 10301",d:"M4.982.237a.81.81,0,0,0-1.145,0l-3.6,3.6A.81.81,0,0,0,1.382,4.982L3.6,2.762c0,.018,0,.036,0,.054V14.328a.81.81,0,1,0,1.62,0V2.816c0-.018,0-.036,0-.054l2.22,2.22A.81.81,0,0,0,8.581,3.837Z",transform:"translate(0 0)",fill:"#6e6e6e"}),e.jsx("path",{id:"Path_10302","data-name":"Path 10302",d:"M136.876,10.157a.81.81,0,0,0-1.145,0l-2.22,2.22c0-.018,0-.036,0-.054V.811a.81.81,0,1,0-1.62,0V12.323c0,.018,0,.036,0,.054l-2.22-2.22a.81.81,0,0,0-1.145,1.145l3.6,3.6a.81.81,0,0,0,1.145,0l3.6-3.6a.81.81,0,0,0,0-1.145",transform:"translate(-119.283 -0.001)",fill:"#6e6e6e"})]})]})})}),e.jsx(K,{placement:"bottom",title:"Filter",children:e.jsx(be,{title:"",open:A,trigger:"click",placement:"bottomLeft",content:e.jsx(Ge,{form:O,setparam:h,pagination:l,setPopOver:b}),className:"filter_listing",onOpenChange:o,overlayClassName:"adjust-filter-main custom-dropdown width_px",children:e.jsx("img",{style:{marginRight:"15px"},src:"https://s3-us-west-2.amazonaws.com/ims-development/static/media/Filter.svg",alt:"",className:"popup-over another-filter"})})})]})]})}):null,e.jsxs("div",{className:"my-custom-table d-flex",onScroll:es,ref:C,children:[e.jsx("div",{className:"customer_scroll_container",children:e.jsxs("div",{id:"wrapper",className:`${c?"listing-events":""}`,children:[e.jsx("div",{className:c?"sticky_table spinner":"sticky_table",children:e.jsx($s,{data:R,loader:c,refetch:p,loading:i,setparam:h,setLoader:g,showDetail:u,pagination:l,hoveredRow:Y,ReturnWidth:y,onRowHover:le,total:(ve=a==null?void 0:a.contacts)==null?void 0:ve.total,handleViewClick:T,setcolsheader:x,selectedProducts:j,tableSetting:a==null?void 0:a.table_setting,colsHeader:P,setSelectedProducts:v,table_slug:m?"supplier":"customer",preferences:(Te=a.table_setting)==null?void 0:Te.preferences,colsHeaderForlockedCols:te,columns:q.filter(t=>t.locked===!0),detailPageColumns:["selection","display_name","action"],handleTableFilterslockedcols:ne,defaultFreezTableWidth:ys((Fe=a.table_setting)==null?void 0:Fe.freez_table_width),actionPref:ks((He=a.table_setting)==null?void 0:He.action_preference,(Oe=q.filter(t=>t.locked===!0))==null?void 0:Oe.length),sidebarPosition:z})}),!u&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"no_sticky_table",children:e.jsx(Bs,{url:se,check:w,loader:c,data:R,refetch:p,loading:i,setparam:h,setLoader:g,hoveredRow:Y,pagination:l,ReturnWidth:y,onRowHover:le,handleSetCheck:X,handleViewClick:T,setcolsheader:x,selectedProducts:j,setColumnHideRef:Z,colsHeader:P,tableSetting:a.table_setting,setColumnOrderRef:_,setSelectedProducts:v,table_slug:m?"supplier":"customer",preferences:(Ae=a.table_setting)==null?void 0:Ae.preferences,colsHeaderForlockedCols:te,columns:q.filter(t=>t.locked===!1),handleTableFilterslockedcols:ne,fixedCollength:(Ee=q.filter(t=>t.locked===!0))==null?void 0:Ee.length,defaultUnFreezTableWidth:Ns((Ie=a.table_setting)==null?void 0:Ie.freez_table_width),column_reset_button:(Be=a==null?void 0:a.table_setting)==null?void 0:Be.column_reset_button,freezeTableWidth:($e=a.table_setting)==null?void 0:$e.freez_table_width,sidebarPosition:z})}),e.jsx("div",{className:"fixed_filter",children:c&&e.jsx(ye,{size:"small"})}),e.jsx("div",{className:"listing-count-main d-flex flex-end",children:e.jsx("p",{children:m?`Total Suppliers : ${re}`:`Total Contacts : ${re}`})})]}),e.jsx("div",{className:"customer_loader",children:i&&!c&&e.jsx(ye,{})})]})}),e.jsxs("div",{className:"sorting_filter",children:[e.jsx("span",{className:l.searchByAlphabet?"custom_activated":"custom_disabled",onClick:()=>{h({...l,page:1,searchByAlphabet:""}),H([])},children:e.jsx(K,{placement:"leftTop",title:"Clear phonebook index",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14.063",height:"9.945",viewBox:"0 0 14.063 9.945",children:e.jsx("g",{id:"sort",transform:"translate(0.5 0.5)",children:e.jsx("path",{id:"Union_4","data-name":"Union 4",d:"M0,8.945V7.178H10.158V8.945ZM1.454,5.351V3.591H11.6v1.76ZM2.9,1.769V0H13.063V1.769Z",transform:"translate(0 0)",stroke:"rgba(0,0,0,0)",strokeMiterlimit:"10",strokeWidth:"1"})})})})}),As.map((t,k)=>e.jsx("span",{onClick:()=>{h({...l,page:1,searchByAlphabet:t.toLocaleLowerCase()}),H([])},children:t},k))]})]})]})};export{Ks as C,qs as S};
