import{e as h,F as i,aW as oe,i as ne,r as a,G as de,ai as me,j as s,y as _e,$ as o,a4 as l,A as C,n as t,D as xe,aA as k,al as j,p as r,T as w,ap as M,bU as be,S as ce,B as O,ak as fe,o as je,l as re}from"./index-4b3d7bc8.js";import{P as he}from"./PaginateSelect-b668bdaf.js";import{I as pe}from"./ItemTable-c0313657.js";const{TextArea:R}=fe,{BILLS:ue,ADD_BILLS:Te}=je,{BILL_CONTACT:ye,BILL_ITEMS:De}=re,V=h(new Date),Se={note:"",bill_no:"",order_no:"",adjustment:0,vendor_id:null,due_date:V,bill_date:V,terms_and_condition:""},Ee=({url:U,close:x,loading:W,onSubmit:z,POdetails:b,handleTotal:$,create:m=!1,isModal:n=!1,handleItemList:q})=>{var y,D,S,I,L,N,E;const[d]=i.useForm(),G=oe(),H=ne(),[J,p]=a.useState(!0),[P,X]=a.useState(0),[K,u]=a.useState([]),[c,Q]=a.useState(0),{bool:Z,setTrue:ee,setFalse:f}=de(!0),{taxList:se,warehouses:le,purchaseAccount:ae,details:e,details:{bill_no:T}}=me(U),te=i.useWatch("adjustment",d)||0;a.useEffect(()=>{d.setFieldsValue({bill_no:T})},[T]),a.useEffect(()=>{m&&n&&e&&Object.keys(e).length&&(d.setFieldsValue({...e}),u(e==null?void 0:e.bill_details),f(),p(!1))},[e,n,m]),a.useEffect(()=>{var _,A,Y,g,v,F,B;!m&&(e!=null&&e.bill_details)&&Object.keys(e==null?void 0:e.bill_details).length&&(d.setFieldsValue({...(_=e==null?void 0:e.bill_details)==null?void 0:_.bill_info,due_date:h((Y=(A=e==null?void 0:e.bill_details)==null?void 0:A.bill_info)==null?void 0:Y.due_date,"YYYY-MM-DD"),bill_date:h((v=(g=e==null?void 0:e.bill_details)==null?void 0:g.bill_info)==null?void 0:v.bill_date,"YYYY-MM-DD")}),u((B=(F=e==null?void 0:e.bill_details)==null?void 0:F.bill_info)==null?void 0:B.bill_item_details),f(),p(!1))},[e==null?void 0:e.bill_details,m]),a.useEffect(()=>{$(c)},[c]);const ie=a.useCallback(_=>X(_),[]);return J&&G.pathname!==Te?s.jsx(_e,{}):s.jsx(s.Fragment,{children:s.jsxs(i,{form:d,name:"item-form",layout:"vertical",autoComplete:"off",onFinish:z,initialValues:Se,children:[s.jsx(o,{children:s.jsx(l,{span:7,offset:1,children:s.jsx(he,{setTrue:ee,name:"vendor_id",url:ye,label:"Vendor Name",setFalse:f,placeholder:"Select or Search Vendor"})})}),s.jsxs("div",{className:Z?"hide":"display",children:[s.jsxs(o,{children:[s.jsxs(l,{span:6,offset:1,children:[s.jsx(C,{disabled:!0,size:"middle",name:"bill_no",label:t.BILL_NO,rules:xe({message:r.bill_no_required})}),s.jsx(i.Item,{name:"bill_date",label:t.BILL_DATE,className:"flex_root",children:s.jsx(k,{name:"bill_date",format:"YYYY-MM-DD"})})]}),s.jsxs(l,{span:6,offset:1,children:[s.jsx(C,{size:"middle",name:"order_no",label:t.ORDER_NO}),s.jsx(i.Item,{name:"due_date",label:t.DUE_DATE,className:"flex_root",children:s.jsx(k,{name:"due_date",format:"YYYY-MM-DD"})})]})]}),s.jsx(pe,{taxes:se,url:De,isModal:n,itemList:K,warehouses:le,adjustment:te,handleItemList:q,handleSubTotal:ie,setTotalAmount:Q,purchaseAccount:ae,currency:(y=e==null?void 0:e.base_currency)==null?void 0:y.symbol,PO_Warehouse_Id:b==null?void 0:b.warehouse_id,edit:(e==null?void 0:e.bill_info)&&Object.keys(e==null?void 0:e.bill_info).length}),s.jsx(j,{}),s.jsxs(o,{children:[s.jsx(l,{span:8,offset:1,children:s.jsx(i.Item,{label:t.NOTES,name:"note",className:"mb flex_root",children:s.jsx(R,{rows:1,placeholder:r.notes})})}),s.jsxs(l,{span:8,offset:4,children:[s.jsxs(o,{children:[s.jsx(l,{children:s.jsx(w.Title,{level:5,style:{marginTop:8},children:"Sub Total"})}),s.jsx(l,{offset:14,children:s.jsx(M,{value:P,prefix:(D=e==null?void 0:e.base_currency)==null?void 0:D.symbol})})]}),s.jsx(o,{children:s.jsx(l,{children:s.jsx(i.Item,{label:t.ADJUSTMENT,name:"adjustment",colon:!1,children:s.jsx(be,{name:"adjustment",addonAfter:(S=e==null?void 0:e.base_currency)==null?void 0:S.symbol,placeholder:`${(I=e==null?void 0:e.base_currency)==null?void 0:I.symbol}0.00`})})})})]})]}),s.jsx(j,{}),s.jsxs(o,{children:[s.jsx(l,{offset:13,children:s.jsx(w.Title,{level:4,style:{marginTop:3},children:"Total"})}),s.jsx(l,{offset:5,children:s.jsx(M,{value:c,prefix:(L=e==null?void 0:e.base_currency)==null?void 0:L.symbol})})]}),s.jsx(j,{}),s.jsx(o,{children:s.jsx(l,{span:10,offset:1,children:s.jsx(i.Item,{className:"flex_root",name:"terms_and_condition",label:t.TERMS_AND_CONDITIONS,children:s.jsx(R,{rows:4,name:"terms_and_condition",placeholder:r.terms_and_conditions})})})}),s.jsxs(ce,{className:n?"steps-action":"",style:{paddingLeft:"46px"},children:[s.jsx(O,{block:!0,loading:W,style:{width:"120px"},btnText:(E=(N=e==null?void 0:e.bill_info)==null?void 0:N.vendor)!=null&&E.display_name?t.UPDATE:t.CREATE}),s.jsx(O,{type:"default",btnText:"Cancel",htmlType:"button",clickHandler:()=>n?x==null?void 0:x():H(ue)})]})]})]})})};export{Ee as B};
